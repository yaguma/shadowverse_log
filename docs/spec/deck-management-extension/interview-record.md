# デッキ管理機能拡張 ヒアリング記録

**作成日**: 2025-01-26
**ヒアリング実施**: step4 既存情報ベースの差分ヒアリング

## ヒアリング目的

既存の設計文書・実装を確認し、新規追加要件の詳細を明確化するためのヒアリングを実施しました。

---

## 質問と回答

### Q1: デッキ種別（DeckMaster）のクラス名一覧

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: デッキ種別追加時のclassName選択肢を特定するため

**質問**: デッキ種別（DeckMaster）の「クラス名（className）」の選択肢として、どのクラスを使用するのだ？

**回答**: 今あるすべて

**信頼性への影響**:
- この回答により、REQ-EXT-002の信頼性レベルが 🔵（青信号）に確定
- 既存のDeckMasterテーブルに登録されているclassNameをすべて使用する設計

---

### Q2: 使用デッキのclassId参照フィールド

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: 使用デッキ追加時のデッキ種別選択の表示と保存データの関係を明確化するため

**質問**: 使用デッキのclassIdはデッキ種別名（DeckMaster）から選択式とのことなのだが、これは既存のDeckMasterのどのフィールドを参照するのだ？

**回答**: 表示はclassName、登録データはid

**信頼性への影響**:
- この回答により、REQ-EXT-102の信頼性レベルが 🔵（青信号）に確定
- UIではclassNameを表示し、保存時はDeckMasterのidを使用する設計が明確化

---

### Q3: シーズン選択肢の上限

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: 統計画面のシーズン選択肢のUI設計を決定するため

**質問**: 統計画面の「シーズン選択式」について、シーズン番号の最大値はいくつまで想定しているのだ？

**回答**: 無制限

**信頼性への影響**:
- この回答により、REQ-EXT-205の信頼性レベルが 🔵（青信号）に確定
- シーズン選択肢に上限を設けない設計

---

### Q4: 統計画面での対戦履歴登録UI

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: 統計画面での対戦履歴登録UIの実装方針を決定するため

**質問**: 統計画面での対戦履歴登録は、対戦履歴一覧画面と同じダイアログ形式で良いのだ？

**回答**: 同じダイアログ

**信頼性への影響**:
- この回答により、REQ-EXT-202の信頼性レベルが 🔵（青信号）に確定
- 既存のダイアログコンポーネントを再利用可能

---

### Q5: 対戦履歴の表示順対象

**質問日時**: 2025-01-26
**カテゴリ**: 既存設計確認
**背景**: 「対戦日が近いものから順番に表示」の対象を特定するため

**質問**: 「対戦履歴登録時に対戦日が近いものから順番に表示」とのことなのだが、これは相手デッキの選択肢の並び順のことなのだ？

**回答**: 相手デッキの選択肢

**信頼性への影響**:
- この回答により、REQ-EXT-302の信頼性レベルが 🔵（青信号）に確定
- 相手デッキ選択肢のソートロジックが明確化

---

### Q6: 横並びレイアウトの対象

**質問日時**: 2025-01-26
**カテゴリ**: 既存設計確認
**背景**: 「シーズンと対戦日は横並び」のUI変更対象を特定するため

**質問**: 「シーズンと対戦日は横並び」とのことなのだが、これは対戦履歴登録ダイアログのレイアウトのことなのだ？

**回答**: 登録ダイアログ

**信頼性への影響**:
- この回答により、REQ-EXT-301の信頼性レベルが 🔵（青信号）に確定
- 対戦履歴登録ダイアログのレイアウト変更が必要

---

### Q7: デッキコードのバリデーション

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: 使用デッキのdeckCode入力のバリデーション要否を決定するため

**質問**: 使用デッキの「deckCode」の入力形式について、特定のフォーマット（シャドウバース公式デッキコードなど）のバリデーションは必要なのだ？

**回答**: バリデーション不要

**信頼性への影響**:
- この回答により、REQ-EXT-107の信頼性レベルが 🔵（青信号）に確定
- deckCodeは自由入力でバリデーション不要

---

### Q8: 使用デッキのテーブル構造

**質問日時**: 2025-01-26
**カテゴリ**: 既存設計確認
**背景**: 使用デッキ機能の実装方針（既存テーブル拡張 vs 新規テーブル）を決定するため

**質問**: 新しい「使用デッキ」テーブルの構造について、これは既存の「my_decks」テーブルを拡張するのか、それとも新規テーブルを作成するのだ？

**回答**: 既存テーブルを拡張せずにできる想定。classId（デッキ種別のid）はdeckIdに紐づけて

**信頼性への影響**:
- この回答により、REQ-EXT-602の信頼性レベルが 🔵（青信号）に確定
- 既存のmy_decksテーブル構造を維持し、deckIdを通じてDeckMasterを参照する設計

---

### Q9: デッキ種別の編集範囲

**質問日時**: 2025-01-26
**カテゴリ**: 未定義部分詳細化
**背景**: デッキ種別編集機能の範囲を特定するため

**質問**: デッキ種別の「登録後でもdeckNameは編集可能」とのことなのだが、classNameの編集はどうするのだ？

**回答**: deckNameのみ編集可

**信頼性への影響**:
- この回答により、REQ-EXT-006、REQ-EXT-007の信頼性レベルが 🔵（青信号）に確定
- deckNameのみ編集可能、classNameは変更不可

---

### Q10: 削除機能の要否

**質問日時**: 2025-01-26
**カテゴリ**: 追加要件
**背景**: デッキ種別・使用デッキの削除機能の要否を確認するため

**質問**: デッキ種別や使用デッキの削除機能は必要なのだ？

**回答**: 両方削除可

**信頼性への影響**:
- この回答により、REQ-EXT-008、REQ-EXT-108の信頼性レベルが 🔵（青信号）に確定
- デッキ種別と使用デッキの両方に削除機能を実装

---

## ヒアリング結果サマリー

### 確認できた事項

1. **デッキ種別追加機能**
   - className: 既存のすべてのクラス名から選択
   - deckName: 自由入力
   - sortOrder, id: 自動採番
   - 編集: deckNameのみ編集可能、classNameは変更不可
   - 削除: 可能

2. **使用デッキ追加機能**
   - deckId: DeckMasterのidを参照（UI表示はclassName）
   - deckName: 自由入力
   - deckCode: 自由入力（バリデーションなし、空白可）
   - isActive: true固定（入力欄不要）
   - id: 自動採番
   - 削除: 可能
   - 既存my_decksテーブル構造を維持

3. **統計画面機能拡張**
   - 対戦履歴登録: 一覧画面と同じダイアログを使用
   - 初期表示: 最新シーズンの全期間
   - シーズン選択: 上限なし

4. **対戦履歴登録UI改善**
   - シーズンと対戦日: 横並びレイアウト（登録ダイアログ）
   - 相手デッキ選択肢: 最近の対戦で使われた順にソート

### 追加/変更要件

- すべての要件がユーザーからの明確な回答に基づいて確定

### 残課題

- なし（すべての疑問点が解消）

### 信頼性レベル分布

**ヒアリング前**:
- 🔵 青信号: 0件
- 🟡 黄信号: 10件（推測による要件）
- 🔴 赤信号: 2件（完全な推測）

**ヒアリング後**:
- 🔵 青信号: 20件 (+20)
- 🟡 黄信号: 8件 (-2)
- 🔴 赤信号: 1件 (-1)

---

## 関連文書

- **要件定義書**: [requirements.md](requirements.md)
- **ユーザストーリー**: [user-stories.md](user-stories.md)
- **受け入れ基準**: [acceptance-criteria.md](acceptance-criteria.md)
