# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒã®é‡è¤‡ï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é•åï¼‰

## æ¦‚è¦

`packages/shared` ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€`apps/api` ãŒç‹¬è‡ªã®ã‚¹ã‚­ãƒ¼ãƒã‚’æŒã£ã¦ã„ã‚‹ã€‚ã“ã‚Œã¯ãƒ¢ãƒãƒ¬ãƒã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆæ„å›³ã«åã—ã¦ãŠã‚Šã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®ä¹–é›¢ã‚’å¼•ãèµ·ã“ã™ã€‚

## å„ªå…ˆåº¦

ğŸ”´ é«˜

## è©²å½“ç®‡æ‰€

| å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | APIé‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ« |
|---------------|-----------------|
| `packages/shared/src/validation/battle-log.ts` | `apps/api/src/db/schema/battle-logs.validation.ts` |
| `packages/shared/src/validation/deck-master.ts` | `apps/api/src/db/schema/deck-master.validation.ts` |
| `packages/shared/src/validation/my-deck.ts` | `apps/api/src/db/schema/my-decks.validation.ts` |

## è©³ç´°

### ç¾çŠ¶ã®å•é¡Œ

1. **äºŒé‡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**: åŒã˜ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’2ç®‡æ‰€ã§ç®¡ç†
2. **ä¹–é›¢ãƒªã‚¹ã‚¯**: ç‰‡æ–¹ã‚’ä¿®æ­£ã—ã¦ã‚‚ã†ç‰‡æ–¹ã‚’å¿˜ã‚Œã‚‹å¯èƒ½æ€§
3. **å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç„¡é§„**: ä½¿ã‚ã‚Œãªã„ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨
4. **ãƒ†ã‚¹ãƒˆã®é‡è¤‡**: ä¸¡æ–¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹

### å…·ä½“ä¾‹ï¼šBattleLogã‚¹ã‚­ãƒ¼ãƒã®æ¯”è¼ƒ

#### packages/shared

```typescript
export const BattleTypeSchema = z.enum(['ãƒ©ãƒ³ã‚¯ãƒãƒƒãƒ', 'ã‚¢ãƒªãƒ¼ãƒŠ', 'ãƒ«ãƒ¼ãƒ ãƒãƒƒãƒ']);
export const RankSchema = z.enum(['ãƒ“ã‚®ãƒŠãƒ¼', 'ãƒ–ãƒ­ãƒ³ã‚º', 'ã‚·ãƒ«ãƒãƒ¼', 'ã‚´ãƒ¼ãƒ«ãƒ‰', 'ãƒ—ãƒ©ãƒãƒŠ', 'ãƒ€ã‚¤ã‚¢ãƒ¢ãƒ³ãƒ‰', 'ãƒã‚¹ã‚¿ãƒ¼', 'ã‚°ãƒ©ãƒ³ãƒ‰ãƒã‚¹ã‚¿ãƒ¼']);
```

#### apps/apiï¼ˆé‡è¤‡ï¼‰

```typescript
export const battleTypeSchema = z.enum(['ãƒ©ãƒ³ã‚¯ãƒãƒƒãƒ', 'ã‚¢ãƒªãƒ¼ãƒŠ', 'ãƒ«ãƒ¼ãƒ ãƒãƒƒãƒ']);
export const rankSchema = z.enum(['ãƒ“ã‚®ãƒŠãƒ¼', 'ãƒ–ãƒ­ãƒ³ã‚º', 'ã‚·ãƒ«ãƒãƒ¼', 'ã‚´ãƒ¼ãƒ«ãƒ‰', 'ãƒ—ãƒ©ãƒãƒŠ', 'ãƒ€ã‚¤ã‚¢ãƒ¢ãƒ³ãƒ‰', 'ãƒã‚¹ã‚¿ãƒ¼', 'ã‚°ãƒ©ãƒ³ãƒ‰ãƒã‚¹ã‚¿ãƒ¼']);
```

## æ”¹å–„æ¡ˆ

### APIã§å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨

```typescript
// apps/api/src/db/schema/battle-logs.validation.ts
import {
  BattleTypeSchema,
  RankSchema,
  GroupSchema,
  TurnSchema,
  ResultSchema,
  CreateBattleLogRequestSchema,
} from '@shadowverse-log/shared';

// å¿…è¦ã«å¿œã˜ã¦APIãƒ¬ã‚¤ãƒ¤ãƒ¼å›ºæœ‰ã®ã‚¹ã‚­ãƒ¼ãƒã®ã¿è¿½åŠ 
export const battleLogQuerySchema = z.object({
  limit: z.coerce.number().min(1).max(100).default(20),
  offset: z.coerce.number().min(0).default(0),
});
```

### å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ§‹é€ æ•´ç†

```
packages/shared/src/validation/
â”œâ”€â”€ battle-log.ts      # BattleLogé–¢é€£ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ deck-master.ts     # DeckMasteré–¢é€£ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ my-deck.ts         # MyDecké–¢é€£ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ common.ts          # å…±é€šã‚¹ã‚­ãƒ¼ãƒï¼ˆæ—¥ä»˜ã€IDç­‰ï¼‰
â””â”€â”€ index.ts           # çµ±ä¸€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

## ä½œæ¥­å†…å®¹

- [ ] `apps/api` ã®é‡è¤‡ã‚¹ã‚­ãƒ¼ãƒã‚’å‰Šé™¤
- [ ] `apps/api` ã§ `@shadowverse-log/shared` ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [ ] APIå›ºæœ‰ã®ã‚¹ã‚­ãƒ¼ãƒï¼ˆã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç­‰ï¼‰ã®ã¿ã‚’ `apps/api` ã«æ®‹ã™
- [ ] å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æœªä½¿ç”¨ã€Œå¾Œæ–¹äº’æ›ã€ã‚¹ã‚­ãƒ¼ãƒã‚’æ•´ç†ï¼ˆé–¢é€£: #012ï¼‰
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã®æ›´æ–°
- [ ] ãƒ†ã‚¹ãƒˆã®çµ±åˆãƒ»æ•´ç†
