# TASK-0032: 相手デッキ選択肢ソート機能 - テストケース

## テストファイル

- `apps/web/src/components/battle-log/BattleLogForm.opponentSort.test.tsx`

## テストケース一覧

### TC-0032-001: 最近使用したデッキが上位に表示される

**前提条件**:
- デッキマスターAPIが使用履歴付きデータを返す
- 複数のデッキに異なる最終使用日が設定されている

**テスト手順**:
1. BattleLogFormをレンダリング
2. 相手デッキのセレクトボックスのオプションを取得
3. オプションの順序を確認

**期待結果**:
- 最終使用日が新しいデッキが先頭に表示される
- 使用履歴のないデッキは末尾に表示される

### TC-0032-002: 使用回数が表示される

**前提条件**:
- デッキマスターAPIが使用回数付きデータを返す

**テスト手順**:
1. BattleLogFormをレンダリング
2. 相手デッキのオプションテキストを確認

**期待結果**:
- 使用回数が0より大きいデッキは「デッキ名 (N回)」形式で表示
- 使用回数が0のデッキはデッキ名のみ表示

### TC-0032-003: 対戦履歴0件時はsortOrder順にフォールバック

**前提条件**:
- すべてのデッキのusageCountが0
- すべてのデッキのlastUsedDateがnull

**テスト手順**:
1. BattleLogFormをレンダリング
2. 相手デッキのオプション順序を確認

**期待結果**:
- sortOrder昇順で表示される

### TC-0032-004: ローディング中の表示

**前提条件**:
- APIレスポンスが遅延している

**テスト手順**:
1. BattleLogFormをレンダリング（APIモックが遅延）
2. ローディング状態を確認

**期待結果**:
- ローディング中は送信ボタンが無効化される
- 適切なローディング表示がされる

### TC-0032-005: APIエラー時のハンドリング

**前提条件**:
- デッキマスターAPIがエラーを返す

**テスト手順**:
1. BattleLogFormをレンダリング（APIモックがエラー）
2. エラーメッセージを確認

**期待結果**:
- エラーメッセージが表示される
- フォームは操作可能な状態を維持

### TC-0032-006: fetchDeckMastersWithUsageが呼び出される

**前提条件**:
- なし

**テスト手順**:
1. BattleLogFormをレンダリング
2. fetchDeckMastersWithUsageの呼び出しを確認

**期待結果**:
- fetchDeckMastersWithUsageが1回呼び出される
- includeUsage=trueパラメータが渡される

## 境界値テスト

### TC-0032-BND-001: デッキマスター0件

**期待結果**: 「デッキマスターを登録してください」メッセージが表示される

### TC-0032-BND-002: デッキマスター1件

**期待結果**: 1件のデッキが選択肢に表示される

### TC-0032-BND-003: 同一最終使用日のデッキ

**期待結果**: sortOrder順でソートされる
