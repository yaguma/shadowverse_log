# TDDテストケース一覧: Statistics Dashboard実装 - 基本統計

**タスクID**: TASK-0018
**タスク名**: Statistics Dashboard実装 - 基本統計
**実装タイプ**: TDD Process
**作成日**: 2025-11-08
**ステータス**: テストケース洗い出し完了

---

## 開発言語・フレームワーク

- **プログラミング言語**: TypeScript 5.7+
  - **言語選択の理由**: フロントエンド技術スタックで採用済み、型安全性による品質向上
  - **テストに適した機能**: インターフェース定義による厳密な型チェック、モックの型安全性
- **テストフレームワーク**: Vitest + React Testing Library + happy-dom
  - **フレームワーク選択の理由**: Vite環境に最適化、高速実行、React Testing Libraryでユーザー視点のテスト
  - **テスト実行環境**: Node.js 22.x + happy-dom（軽量DOM環境）
- 🔵 信頼性レベル: `docs/tech-stack.md`, `frontend/vitest.config.ts`より

---

## テストケース分類サマリー

| 分類 | 件数 | 概要 |
|------|------|------|
| 正常系 | 10 | 基本的な機能動作の確認 |
| 異常系 | 6 | エラーハンドリングの確認 |
| 境界値 | 4 | 極端な条件下での動作確認 |
| UI/UX | 3 | ユーザーインタラクションの確認 |
| **合計** | **23** | **全テストケース** |

---

## 1. 正常系テストケース（基本的な動作）

### TC-STATS-001: ページ初期表示 - デフォルト期間（過去7日間）で統計情報が表示される

- **テスト名**: ページ初期表示で過去7日間の統計情報が自動取得・表示される
  - **何をテストするか**: StatisticsDashboardPageコンポーネントの初回マウント時の動作
  - **期待される動作**: デフォルト期間（今日から7日前）で自動的にAPI呼び出しが実行され、統計情報が表示される
- **入力値**: なし（初回マウント）
  - **入力データの意味**: ページアクセス時のデフォルト動作を確認
- **期待される結果**:
  - startDate: 今日から7日前の日付（YYYY-MM-DD形式）
  - endDate: 今日の日付（YYYY-MM-DD形式）
  - `apiClient.get('/api/statistics?startDate=...&endDate=...')` が呼ばれる
  - 統計情報（overall, byMyDeck, byOpponentDeck, byRank, byTurn）が表示される
  - **期待結果の理由**: REQ-202（期間選択機能）、デフォルト期間は直近7日間が妥当
- **テストの目的**: 初期表示時の自動データ取得機能を確認
  - **確認ポイント**: デフォルト期間計算の正確性、API呼び出しの正しさ、統計表示の完全性
- 🔵 信頼性レベル: 要件定義書 REQ-201, REQ-202 に基づく

---

### TC-STATS-002: 全体統計が正しく表示される

- **テスト名**: 全体統計（総試合数、勝数、敗数、勝率）が正しく表示される
  - **何をテストするか**: OverallStatsコンポーネントの表示機能
  - **期待される動作**: APIレスポンスのoverall統計が正確に表示される
- **入力値**:
  ```typescript
  overall: {
    totalGames: 150,
    wins: 98,
    losses: 52,
    winRate: 65.3
  }
  ```
  - **入力データの意味**: 150試合中98勝52敗、勝率65.3%のサンプルデータ
- **期待される結果**:
  - 「総試合数: 150試合」が表示される
  - 「勝数: 98勝」が表示される
  - 「敗数: 52敗」が表示される
  - 「勝率: 65.3%」が表示される
  - **期待結果の理由**: REQ-203（全体勝率表示）より
- **テストの目的**: 全体統計の表示機能を確認
  - **確認ポイント**: 数値の正確性、パーセンテージ表示（小数点第1位まで）
- 🔵 信頼性レベル: 要件定義書 REQ-203 に基づく

---

### TC-STATS-003: デッキ別統計が正しく表示される

- **テスト名**: マイデッキ別・相手デッキ別の統計が正しく表示される
  - **何をテストするか**: DeckStatsTableコンポーネントの表示機能
  - **期待される動作**: APIレスポンスのbyMyDeck, byOpponentDeck統計が正確に表示される
- **入力値**:
  ```typescript
  byMyDeck: [
    { deckId: "deck_001", deckName: "秘術オデンスペル", totalGames: 75, wins: 50, losses: 25, winRate: 66.7 },
    { deckId: "deck_002", deckName: "進化葬送ネクロ", totalGames: 75, wins: 48, losses: 27, winRate: 64.0 }
  ],
  byOpponentDeck: [
    { deckId: "deck_master_005", deckName: "進化ネクロ", totalGames: 30, wins: 20, losses: 10, winRate: 66.7 }
  ]
  ```
  - **入力データの意味**: マイデッキ2種類、相手デッキ1種類の統計データ
- **期待される結果**:
  - マイデッキ別統計テーブルに2行表示される
  - デッキ名、試合数、勝数、敗数、勝率が正しく表示される
  - 相手デッキ別統計テーブルに1行表示される
  - **期待結果の理由**: REQ-203（デッキ別勝率表示）より
- **テストの目的**: デッキ別統計の表示機能を確認
  - **確認ポイント**: テーブル行数の正確性、各列の値の正しさ
- 🔵 信頼性レベル: 要件定義書 REQ-203 に基づく

---

### TC-STATS-004: ランク帯別統計が正しく表示される

- **テスト名**: ランク帯別の統計が正しく表示される
  - **何をテストするか**: RankStatsTableコンポーネントの表示機能
  - **期待される動作**: APIレスポンスのbyRank統計が正確に表示される
- **入力値**:
  ```typescript
  byRank: [
    { rank: "ダイアモンド", group: "AAA", totalGames: 80, wins: 55, losses: 25, winRate: 68.8 },
    { rank: "ルビー", group: "Master", totalGames: 70, wins: 43, losses: 27, winRate: 61.4 }
  ]
  ```
  - **入力データの意味**: ダイアモンドAAAとルビーMasterの2ランク帯の統計データ
- **期待される結果**:
  - ランク帯別統計テーブルに2行表示される
  - ランク、グループ、試合数、勝数、敗数、勝率が正しく表示される
  - **期待結果の理由**: REQ-203（ランク帯別成績表示）より
- **テストの目的**: ランク帯別統計の表示機能を確認
  - **確認ポイント**: ランク+グループの組み合わせ表示、各列の値の正しさ
- 🔵 信頼性レベル: 要件定義書 REQ-203 に基づく

---

### TC-STATS-005: 先攻後攻別統計が正しく表示される

- **テスト名**: 先攻後攻別の統計が正しく表示される
  - **何をテストするか**: TurnStatsコンポーネントの表示機能
  - **期待される動作**: APIレスポンスのbyTurn統計が正確に表示される
- **入力値**:
  ```typescript
  byTurn: {
    先攻: { totalGames: 78, wins: 52, losses: 26, winRate: 66.7 },
    後攻: { totalGames: 72, wins: 46, losses: 26, winRate: 63.9 }
  }
  ```
  - **入力データの意味**: 先攻78試合、後攻72試合の統計データ
- **期待される結果**:
  - 先攻の統計が表示される（試合数: 78、勝率: 66.7%）
  - 後攻の統計が表示される（試合数: 72、勝率: 63.9%）
  - **期待結果の理由**: REQ-203（先攻後攻別統計）より
- **テストの目的**: 先攻後攻別統計の表示機能を確認
  - **確認ポイント**: 先攻・後攻の両方が表示される、勝率の正確性
- 🔵 信頼性レベル: 要件定義書 REQ-203 に基づく

---

### TC-STATS-006: 期間選択で統計情報が更新される

- **テスト名**: 開始日・終了日を変更して検索ボタンをクリックすると統計情報が更新される
  - **何をテストするか**: PeriodSelectorコンポーネントの期間変更機能
  - **期待される動作**: 期間を変更して検索ボタンをクリックするとAPI呼び出しが再実行される
- **入力値**:
  - startDate: "2025-01-01"
  - endDate: "2025-01-31"
  - **入力データの意味**: 2025年1月の1ヶ月間の統計を確認
- **期待される結果**:
  - `apiClient.get('/api/statistics?startDate=2025-01-01&endDate=2025-01-31')` が呼ばれる
  - ローディング状態が表示される
  - 新しい統計情報が表示される
  - **期待結果の理由**: REQ-202（集計期間選択機能）より
- **テストの目的**: 期間変更による統計更新機能を確認
  - **確認ポイント**: API再呼び出しの正しさ、ローディング表示、統計更新の反映
- 🔵 信頼性レベル: 要件定義書 REQ-202 に基づく

---

### TC-STATS-007: ローディング状態が正しく表示される

- **テスト名**: API呼び出し中はローディングスピナーが表示される
  - **何をテストするか**: Loading Stateの表示機能
  - **期待される動作**: isLoading=trueの間、ローディングスピナーが表示される
- **入力値**: isLoading: true
  - **入力データの意味**: API呼び出し中の状態をシミュレート
- **期待される結果**:
  - ローディングスピナーが表示される
  - 統計情報は表示されない
  - **期待結果の理由**: REQ-502（ローディングインジケーター表示）より
- **テストの目的**: ローディング状態の表示機能を確認
  - **確認ポイント**: ローディングスピナーの表示、統計情報の非表示
- 🔵 信頼性レベル: 要件定義書 REQ-502 に基づく

---

### TC-STATS-008: データが0件の場合に「データなし」メッセージが表示される

- **テスト名**: 選択期間にデータが0件の場合、「データなし」メッセージが表示される
  - **何をテストするか**: Empty Stateの表示機能
  - **期待される動作**: overall.totalGames=0の場合、データなしメッセージが表示される
- **入力値**:
  ```typescript
  overall: { totalGames: 0, wins: 0, losses: 0, winRate: 0 },
  byMyDeck: [],
  byOpponentDeck: [],
  byRank: [],
  byTurn: { 先攻: { totalGames: 0, wins: 0, losses: 0, winRate: 0 }, 後攻: { totalGames: 0, wins: 0, losses: 0, winRate: 0 } }
  ```
  - **入力データの意味**: 選択期間に対戦履歴が存在しない状態
- **期待される結果**:
  - 「指定期間にデータがありません」のメッセージが表示される
  - 統計テーブルは表示されない
  - **期待結果の理由**: REQ-405（データなしメッセージ表示）より
- **テストの目的**: データ0件時のメッセージ表示を確認
  - **確認ポイント**: メッセージの内容、統計テーブルの非表示
- 🔵 信頼性レベル: 要件定義書 REQ-405 に基づく

---

### TC-STATS-009: 期間選択のデフォルト値が正しく設定される

- **テスト名**: 期間選択フォームのデフォルト値が過去7日間に設定される
  - **何をテストするか**: PeriodSelectorコンポーネントの初期値設定
  - **期待される動作**: startDate=今日から7日前、endDate=今日の日付が初期値として設定される
- **入力値**: なし（初回マウント）
  - **入力データの意味**: ページアクセス時のデフォルト動作を確認
- **期待される結果**:
  - startDate input要素のvalue属性が今日から7日前の日付（YYYY-MM-DD形式）
  - endDate input要素のvalue属性が今日の日付（YYYY-MM-DD形式）
  - **期待結果の理由**: 統計分析の一般的なユースケース（直近1週間の確認）
- **テストの目的**: 期間選択フォームの初期値設定を確認
  - **確認ポイント**: 日付計算の正確性、YYYY-MM-DD形式の正しさ
- 🟡 信頼性レベル: 一般的なUX要件から推測

---

### TC-STATS-010: API呼び出しが正しいクエリパラメータで実行される

- **テスト名**: 期間選択後、正しいクエリパラメータでAPI呼び出しが実行される
  - **何をテストするか**: API呼び出し時のクエリパラメータ構築
  - **期待される動作**: startDate, endDateがクエリパラメータとして正しく渡される
- **入力値**:
  - startDate: "2025-02-01"
  - endDate: "2025-02-28"
  - **入力データの意味**: 2025年2月の1ヶ月間
- **期待される結果**:
  - `apiClient.get('/api/statistics?startDate=2025-02-01&endDate=2025-02-28')` が呼ばれる
  - **期待結果の理由**: TASK-0010 Statistics API仕様より
- **テストの目的**: API呼び出しの正確性を確認
  - **確認ポイント**: クエリパラメータの形式、日付フォーマットの正しさ
- 🔵 信頼性レベル: TASK-0010 API仕様に基づく

---

## 2. 異常系テストケース（エラーハンドリング）

### TC-STATS-ERR-001: ネットワークエラー時にエラーメッセージが表示される

- **テスト名**: ネットワークエラー発生時に適切なエラーメッセージが表示される
  - **エラーケースの概要**: インターネット接続が切断されている状況
  - **エラー処理の重要性**: ユーザーにエラー原因を明確に伝え、再試行を促す
- **入力値**: `apiClient.get()` がネットワークエラーを投げる
  - **不正な理由**: ネットワーク接続が利用できない
  - **実際の発生シナリオ**: モバイル環境でのオフライン状態、Wi-Fi切断時
- **期待される結果**:
  - エラーメッセージ「ネットワークエラーが発生しました。接続を確認してください。」が表示される
  - 再試行ボタンが表示される
  - 統計情報は表示されない
  - **エラーメッセージの内容**: ユーザーフレンドリーで原因が明確
  - **システムの安全性**: エラー時でもUIが壊れず、再試行可能
- **テストの目的**: ネットワークエラー時のエラーハンドリングを確認
  - **品質保証の観点**: オフライン環境での堅牢性、ユーザー体験の保証
- 🔵 信頼性レベル: 一般的なエラーハンドリング要件

---

### TC-STATS-ERR-002: サーバーエラー (500) 時にエラーメッセージが表示される

- **テスト名**: Backend APIがサーバーエラー（500）を返した場合にエラーメッセージが表示される
  - **エラーケースの概要**: Backend APIの内部エラー
  - **エラー処理の重要性**: サーバー側の問題をユーザーに適切に伝える
- **入力値**: `apiClient.get()` が500エラーを返す
  - **不正な理由**: サーバー側の処理エラー（Blob Storage接続エラー等）
  - **実際の発生シナリオ**: Azure Functions実行エラー、Blob Storageアクセス失敗
- **期待される結果**:
  - エラーメッセージ「サーバーエラーが発生しました。しばらくしてから再試行してください。」が表示される
  - 再試行ボタンが表示される
  - **エラーメッセージの内容**: サーバー側の問題であることを明示
  - **システムの安全性**: エラー時でもアプリケーションがクラッシュしない
- **テストの目的**: サーバーエラー時のエラーハンドリングを確認
  - **品質保証の観点**: Backend障害時の堅牢性、ユーザー体験の保証
- 🔵 信頼性レベル: 一般的なエラーハンドリング要件

---

### TC-STATS-ERR-003: 開始日 > 終了日の場合にバリデーションエラーが表示される

- **テスト名**: 開始日が終了日より後の日付の場合、バリデーションエラーが表示される
  - **エラーケースの概要**: 期間選択の論理エラー
  - **エラー処理の重要性**: 不正な期間での検索を防ぎ、データ整合性を保つ
- **入力値**:
  - startDate: "2025-01-31"
  - endDate: "2025-01-01"
  - **不正な理由**: 開始日が終了日より後
  - **実際の発生シナリオ**: ユーザーの入力ミス、日付選択の誤操作
- **期待される結果**:
  - バリデーションエラーメッセージ「開始日は終了日以前の日付を選択してください」が表示される
  - API呼び出しは実行されない
  - **エラーメッセージの内容**: 修正方法が明確
  - **システムの安全性**: 不正な期間でのAPI呼び出しを防ぐ
- **テストの目的**: 期間選択のバリデーション機能を確認
  - **品質保証の観点**: ユーザー入力エラーの防止、データ整合性の保証
- 🟡 信頼性レベル: 一般的なUX要件から推測

---

### TC-STATS-ERR-004: 未来の日付を選択した場合にバリデーションエラーが表示される

- **テスト名**: 終了日に未来の日付を選択した場合、バリデーションエラーが表示される
  - **エラーケースの概要**: 未来の日付での統計検索
  - **エラー処理の重要性**: データ整合性の保証（未来のデータは存在しない）
- **入力値**:
  - endDate: "2099-12-31"
  - **不正な理由**: 未来の日付
  - **実際の発生シナリオ**: ユーザーの入力ミス、日付選択の誤操作
- **期待される結果**:
  - バリデーションエラーメッセージ「未来の日付は選択できません」が表示される
  - API呼び出しは実行されない
  - **エラーメッセージの内容**: 未来の日付が不正であることを明示
  - **システムの安全性**: 不正な期間でのAPI呼び出しを防ぐ
- **テストの目的**: 未来日付のバリデーション機能を確認
  - **品質保証の観点**: データ整合性の保証、ユーザー入力エラーの防止
- 🟡 信頼性レベル: REQ-401（対戦履歴登録の未来日付禁止）から類推

---

### TC-STATS-ERR-005: 日付フォーマットが不正な場合にバリデーションエラーが表示される

- **テスト名**: 不正な日付フォーマットの場合、バリデーションエラーが表示される
  - **エラーケースの概要**: YYYY-MM-DD形式以外の日付入力
  - **エラー処理の重要性**: API呼び出しの失敗を防ぐ
- **入力値**:
  - startDate: "2025/01/01" (スラッシュ区切り)
  - **不正な理由**: YYYY-MM-DD形式ではない
  - **実際の発生シナリオ**: 手入力による形式ミス
- **期待される結果**:
  - バリデーションエラーメッセージ「日付はYYYY-MM-DD形式で入力してください」が表示される
  - API呼び出しは実行されない
  - **エラーメッセージの内容**: 正しい形式が明示される
  - **システムの安全性**: 不正なフォーマットでのAPI呼び出しを防ぐ
- **テストの目的**: 日付フォーマットのバリデーション機能を確認
  - **品質保証の観点**: API仕様との整合性保証
- 🟡 信頼性レベル: TASK-0010 API仕様から推測

---

### TC-STATS-ERR-006: 再試行ボタンでAPI呼び出しが再実行される

- **テスト名**: エラー表示後、再試行ボタンをクリックするとAPI呼び出しが再実行される
  - **エラーケースの概要**: エラー後の再試行機能
  - **エラー処理の重要性**: ユーザーが自力で復旧できる仕組み
- **入力値**: エラー状態からの再試行
  - **不正な理由**: 初回API呼び出しが失敗
  - **実際の発生シナリオ**: 一時的なネットワークエラー後の復旧
- **期待される結果**:
  - 再試行ボタンをクリックすると`apiClient.get()`が再実行される
  - ローディング状態が表示される
  - 成功すれば統計情報が表示される
  - **エラーメッセージの内容**: N/A
  - **システムの安全性**: ユーザーが自力で復旧可能
- **テストの目的**: 再試行機能の動作を確認
  - **品質保証の観点**: ユーザビリティ、エラー復旧機能の保証
- 🟡 信頼性レベル: 一般的なUX要件から推測

---

## 3. 境界値テストケース（最小値、最大値、null等）

### TC-STATS-BOUND-001: 開始日=終了日（1日間）の場合の統計表示

- **テスト名**: 開始日と終了日が同じ日付（1日間）の場合、統計が正しく表示される
  - **境界値の意味**: 最小期間（1日間）での統計検索
  - **境界値での動作保証**: 1日間でも正常に統計計算が行われる
- **入力値**:
  - startDate: "2025-01-15"
  - endDate: "2025-01-15"
  - **境界値選択の根拠**: 最小期間（1日間）
  - **実際の使用場面**: 特定の1日だけの成績を確認したい場合
- **期待される結果**:
  - API呼び出しが実行される
  - 統計情報が表示される（1日分のデータ）
  - **境界での正確性**: 1日分のデータでも正確に集計される
  - **一貫した動作**: 複数日と同じ表示形式
- **テストの目的**: 最小期間での統計表示を確認
  - **堅牢性の確認**: 極端に短い期間でもシステムが正常動作する
- 🟡 信頼性レベル: 境界値テストのベストプラクティスから推測

---

### TC-STATS-BOUND-002: 期間が1年間（365日）の場合の統計表示

- **テスト名**: 期間が1年間（365日）の場合、統計が正しく表示される
  - **境界値の意味**: 長期間（1年間）での統計検索
  - **境界値での動作保証**: 長期間でもパフォーマンスが問題ない
- **入力値**:
  - startDate: "2024-01-01"
  - endDate: "2024-12-31"
  - **境界値選択の根拠**: 長期間（1年間）
  - **実際の使用場面**: 年間成績を確認したい場合
- **期待される結果**:
  - API呼び出しが実行される
  - 統計情報が表示される（1年分のデータ）
  - ローディング時間が許容範囲内（3秒以内）
  - **境界での正確性**: 大量データでも正確に集計される
  - **一貫した動作**: 短期間と同じ表示形式
- **テストの目的**: 長期間での統計表示とパフォーマンスを確認
  - **堅牢性の確認**: 大量データでもシステムが安定動作する
- 🟡 信頼性レベル: 境界値テストのベストプラクティスから推測

---

### TC-STATS-BOUND-003: デッキ統計が0件の場合の表示

- **テスト名**: byMyDeck, byOpponentDeckが空配列の場合、適切なメッセージが表示される
  - **境界値の意味**: デッキ統計データが存在しない状態
  - **境界値での動作保証**: 空配列でもエラーが発生しない
- **入力値**:
  ```typescript
  byMyDeck: [],
  byOpponentDeck: []
  ```
  - **境界値選択の根拠**: 最小データ件数（0件）
  - **実際の使用場面**: 対戦履歴が1件もない期間
- **期待される結果**:
  - デッキ統計テーブルが表示されない
  - 「この期間にデッキ統計がありません」のようなメッセージが表示される
  - **境界での正確性**: 空配列でもエラーが発生しない
  - **一貫した動作**: overall統計と整合性がある
- **テストの目的**: 空配列でのエラーハンドリングを確認
  - **堅牢性の確認**: エッジケースでもシステムが安定動作する
- 🟡 信頼性レベル: 境界値テストのベストプラクティスから推測

---

### TC-STATS-BOUND-004: 勝率が0%および100%の場合の表示

- **テスト名**: 勝率が0%または100%の極端な値の場合、正しく表示される
  - **境界値の意味**: 勝率の最小値・最大値
  - **境界値での動作保証**: 極端な勝率でも正確に表示される
- **入力値**:
  ```typescript
  byMyDeck: [
    { deckId: "deck_001", deckName: "全敗デッキ", totalGames: 10, wins: 0, losses: 10, winRate: 0.0 },
    { deckId: "deck_002", deckName: "全勝デッキ", totalGames: 10, wins: 10, losses: 0, winRate: 100.0 }
  ]
  ```
  - **境界値選択の根拠**: 勝率の境界値（0%, 100%）
  - **実際の使用場面**: 全勝または全敗のデッキ
- **期待される結果**:
  - 全敗デッキの勝率が「0.0%」と表示される
  - 全勝デッキの勝率が「100.0%」と表示される
  - **境界での正確性**: 極端な値でも正確に表示される
  - **一貫した動作**: 小数点第1位までの表示形式が維持される
- **テストの目的**: 極端な勝率での表示を確認
  - **堅牢性の確認**: 境界値でも表示が崩れない
- 🟡 信頼性レベル: 境界値テストのベストプラクティスから推測

---

## 4. UI/UXテストケース（ユーザーインタラクション）

### TC-STATS-UX-001: レスポンシブデザイン - モバイル表示でテーブルがカード表示になる

- **テスト名**: モバイルビューポート（< 768px）でテーブルがカード表示に切り替わる
  - **何をテストするか**: レスポンシブデザインの動作
  - **期待される動作**: ビューポート幅に応じてレイアウトが変更される
- **入力値**: ビューポート幅を375px（iPhone SE）に設定
  - **入力データの意味**: モバイル環境をシミュレート
- **期待される結果**:
  - デッキ統計テーブルがカード表示に切り替わる
  - 各カードにデッキ名、試合数、勝率が表示される
  - **期待結果の理由**: REQ-603（レスポンシブデザイン）より
- **テストの目的**: レスポンシブデザインの動作を確認
  - **確認ポイント**: モバイル表示での可読性、タップ可能な要素のサイズ
- 🔵 信頼性レベル: 要件定義書 REQ-603 に基づく

---

### TC-STATS-UX-002: 検索ボタンクリック時のローディングフィードバック

- **テスト名**: 検索ボタンをクリックすると即座にローディング状態が表示される
  - **何をテストするか**: ローディングフィードバックのタイミング
  - **期待される動作**: ボタンクリック直後にローディングスピナーが表示される
- **入力値**: 検索ボタンクリック
  - **入力データの意味**: ユーザーのアクション
- **期待される結果**:
  - 検索ボタンがdisabled状態になる
  - ローディングスピナーが表示される
  - API呼び出しが完了するまでローディング状態が継続する
  - **期待結果の理由**: REQ-502（ローディングインジケーター表示）より
- **テストの目的**: ローディングフィードバックのUXを確認
  - **確認ポイント**: ボタンのdisabled状態、ローディングのタイミング
- 🔵 信頼性レベル: 要件定義書 REQ-502 に基づく

---

### TC-STATS-UX-003: 期間選択フォームのアクセシビリティ

- **テスト名**: 期間選択フォームがキーボード操作でアクセス可能である
  - **何をテストするか**: キーボードナビゲーション対応
  - **期待される動作**: Tabキーでフォーカス移動、Enterキーで検索実行が可能
- **入力値**: キーボード操作（Tab, Enter）
  - **入力データの意味**: キーボードのみでの操作性を確認
- **期待される結果**:
  - startDate → endDate → 検索ボタンの順にフォーカス移動可能
  - 検索ボタンにフォーカスがある状態でEnterキーを押すと検索が実行される
  - **期待結果の理由**: REQ-603（アクセシビリティ準拠）より
- **テストの目的**: キーボードアクセシビリティを確認
  - **確認ポイント**: フォーカス順序の正しさ、Enterキー操作の動作
- 🟡 信頼性レベル: 一般的なアクセシビリティ要件から推測

---

## テストケース実装ガイド

### Given-When-Thenパターンの適用

すべてのテストケースは以下のパターンで実装します：

```typescript
it('TC-STATS-001: ページ初期表示 - デフォルト期間で統計情報が表示される', async () => {
  // 【テスト目的】: StatisticsDashboardPageコンポーネントの初回マウント時の動作を確認
  // 【テスト内容】: デフォルト期間（過去7日間）で自動的にAPI呼び出しが実行され、統計情報が表示される
  // 【期待される動作】: startDate=今日-7日, endDate=今日の日付でAPIが呼ばれ、統計が表示される
  // 🔵 信頼性レベル: REQ-201, REQ-202 に基づく

  // ========== Given: テストデータ準備 ==========
  // 【テストデータ準備】: モックAPIレスポンスを用意
  // 【初期条件設定】: ページ初回マウント状態を想定
  const mockStatistics = {
    overall: { totalGames: 150, wins: 98, losses: 52, winRate: 65.3 },
    byMyDeck: [/* ... */],
    // ...
  };
  vi.mocked(apiClient.get).mockResolvedValueOnce({ data: mockStatistics });

  // ========== When: 実際の処理実行 ==========
  // 【実際の処理実行】: StatisticsDashboardPageコンポーネントをマウント
  // 【処理内容】: useEffect内でAPI呼び出しが自動実行される
  render(<StatisticsDashboardPage />);

  // ========== Then: 結果検証 ==========
  // 【結果検証】: ローディング状態が表示され、その後統計情報が表示される
  // 【期待値確認】: APIが正しいパラメータで呼ばれ、統計が表示される

  // 【検証項目】: ローディングスピナーが表示される 🔵
  expect(screen.getByRole('status')).toBeInTheDocument();

  // 【検証項目】: API呼び出しが実行される 🔵
  await waitFor(() => {
    const today = new Date().toISOString().split('T')[0];
    const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
    expect(apiClient.get).toHaveBeenCalledWith(`/api/statistics?startDate=${sevenDaysAgo}&endDate=${today}`);
  });

  // 【検証項目】: 全体統計が表示される 🔵
  await waitFor(() => {
    expect(screen.getByText('総試合数: 150試合')).toBeInTheDocument();
    expect(screen.getByText('勝率: 65.3%')).toBeInTheDocument();
  });
});
```

---

## 品質判定

✅ **高品質**:
- ✅ テストケース分類: 正常系（10件）、異常系（6件）、境界値（4件）、UI/UX（3件）が網羅されている
- ✅ 期待値定義: 各テストケースの期待値が明確（統計値、エラーメッセージ、UI状態）
- ✅ 技術選択: TypeScript + Vitest + React Testing Library（技術スタック確定済み）
- ✅ 実装可能性: 既存のテストパターン（BattleLogForm, BattleLogList）を参考に実装可能

**判定結果**: ✅ 高品質 - TDDレッドフェーズ（失敗テスト作成）へ進む準備が整いました

---

## 次のステップ

次のお勧めステップ: `/tsumiki:tdd-red` でRedフェーズ（失敗テスト作成）を開始します。
