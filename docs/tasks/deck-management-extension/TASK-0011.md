# TASK-0011: DeckMasterItemコンポーネント実装

**タスクID**: TASK-0011
**タスクタイプ**: TDD
**推定工数**: 2時間
**フェーズ**: Phase 2 - デッキ種別管理機能
**信頼性レベル**: 🔵 *interfaces.ts DeckMasterItemPropsより*

## 関連文書
- [技術設計書](../../design/deck-management-extension/README.md)
- [アーキテクチャ設計](../../design/deck-management-extension/architecture.md)
- [インターフェース定義](../../design/deck-management-extension/interfaces.ts)

## タスク概要
デッキ種別の個別アイテムコンポーネントを実装する。className、deckNameの表示、編集/削除ボタン、削除確認ダイアログを含む。

## 依存タスク
- **前提タスク**: [TASK-0010](TASK-0010.md) - DeckMasterListコンポーネント
- **後続タスク**: [TASK-0012](TASK-0012.md) - DeckMasterDialogコンポーネント

## 完了条件
- [ ] className、deckNameが表示されること
- [ ] 編集ボタンが機能すること
- [ ] 削除ボタンが機能すること（参照ありで無効化）
- [ ] 削除確認ダイアログが表示されること
- [ ] 全テストがパスすること

---
## 実装詳細

### ファイル構成
```
packages/web/src/
├── components/
│   └── deck-master/
│       ├── DeckMasterItem.tsx      # アイテムコンポーネント（新規）
│       ├── DeckMasterItem.test.tsx # テスト（新規）
│       └── DeleteConfirmDialog.tsx # 削除確認ダイアログ（新規）
```

### コンポーネント構造
```typescript
interface DeckMasterItemProps {
  deckMaster: DeckMasterWithUsage;
  onEdit: (deckMaster: DeckMasterWithUsage) => void;
  onDelete: (id: string) => void;
  canDelete: boolean;  // usageCount === 0 の場合 true
}

const DeckMasterItem: React.FC<DeckMasterItemProps> = ({
  deckMaster,
  onEdit,
  onDelete,
  canDelete,
}) => {
  // 実装
};
```

### UI構成

#### メイン表示部分
```
┌─────────────────────────────────────────────────┐
│ [クラスアイコン] ウィッチ                         │
│ 秘術ウィッチ                                     │
│                                                 │
│ 使用回数: 15回  最終使用: 2024/01/15            │
│                                                 │
│                    [編集] [削除]                 │
└─────────────────────────────────────────────────┘
```

#### 削除ボタン状態
- canDelete=true: 通常表示、クリック可能
- canDelete=false: グレーアウト、disabled、ツールチップ「対戦履歴で使用中」

#### 削除確認ダイアログ
```
┌─────────────────────────────────────────────────┐
│ デッキ種別の削除                                 │
│                                                 │
│ 「秘術ウィッチ」を削除してもよろしいですか？      │
│                                                 │
│ この操作は取り消せません。                       │
│                                                 │
│                    [キャンセル] [削除]           │
└─────────────────────────────────────────────────┘
```

---
## 単体テスト要件

### テストファイル
`packages/web/src/components/deck-master/DeckMasterItem.test.tsx`

### テストケース

#### 表示テスト
1. **className、deckNameが表示される**
   - 入力: { className: "ウィッチ", deckName: "秘術ウィッチ" }
   - 期待: "ウィッチ"、"秘術ウィッチ"がDOMに存在

2. **使用回数が表示される**
   - 入力: { usageCount: 15 }
   - 期待: "15回"がDOMに存在

3. **最終使用日が表示される**
   - 入力: { lastUsedDate: "2024-01-15T10:30:00.000Z" }
   - 期待: "2024/01/15"がDOMに存在

4. **最終使用日がnullの場合「未使用」表示**
   - 入力: { lastUsedDate: null }
   - 期待: "未使用"がDOMに存在

#### 編集ボタンテスト
5. **編集ボタンクリックでonEditが呼ばれる**
   - 期待: onEditがdeckMasterオブジェクトと共に呼ばれる

#### 削除ボタンテスト
6. **削除ボタンクリックで確認ダイアログが表示される**
   - 入力: canDelete: true
   - 期待: 確認ダイアログがDOMに存在

7. **確認ダイアログでキャンセルするとonDeleteが呼ばれない**
   - 期待: onDeleteが呼ばれない、ダイアログが閉じる

8. **確認ダイアログで削除するとonDeleteが呼ばれる**
   - 期待: onDeleteがidと共に呼ばれる

9. **canDelete=falseで削除ボタンが無効化される**
   - 入力: canDelete: false
   - 期待: 削除ボタンがdisabled

10. **canDelete=falseでツールチップが表示される**
    - 入力: canDelete: false
    - 期待: ホバー時に「対戦履歴で使用中」ツールチップ

---
## 実装手順

### Red Phase（失敗するテストを書く）
1. テストファイル `DeckMasterItem.test.tsx` を作成
2. React Testing Libraryでテスト実装
3. テスト実行 → 失敗確認

### Green Phase（テストを通す最小実装）
1. DeckMasterItemコンポーネント作成
2. 表示ロジック実装
3. 編集/削除ボタン実装
4. DeleteConfirmDialogコンポーネント作成
5. テスト実行 → 成功確認

### Refactor Phase（リファクタリング）
1. 日付フォーマット関数の共通化
2. スタイリングの整理
3. アクセシビリティ対応
4. テスト実行 → 成功確認

---
## 信頼性レベルサマリー

| 項目 | レベル | 出典 |
|------|--------|------|
| コンポーネント構造 | 🔵 | interfaces.ts DeckMasterItemProps |
| 削除制約表示 | 🔵 | REQ-EXT-008, REQ-EXT-401 |
| 削除確認ダイアログ | 🔵 | architecture.md |
| UI表示項目 | 🔵 | architecture.md 2.1 |
