# TASK-0004: APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå…±é€šå‡¦ç†æ‹¡å¼µ

**ã‚¿ã‚¹ã‚¯ID**: TASK-0004
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 2æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 1 - åŸºç›¤ãƒ»å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ *æ—¢å­˜APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æ¨æ¸¬*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [ğŸ“‹ overview.md](overview.md)
- **è¦ä»¶å®šç¾©**: [ğŸ“‹ requirements.md](../../spec/deck-management-extension/requirements.md)
- **è¨­è¨ˆæ–‡æ›¸**: [ğŸ“ architecture.md](../../design/deck-management-extension/architecture.md)
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©**: [ğŸ“ interfaces.ts](../../design/deck-management-extension/interfaces.ts)
- **æ—¢å­˜APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ**: `apps/web/src/api/client.ts`

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

ãƒ‡ãƒƒã‚­ç®¡ç†æ©Ÿèƒ½ã§ä½¿ç”¨ã™ã‚‹APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚æ—¢å­˜ã®ApiClientã‚¯ãƒ©ã‚¹ã‚’æ´»ç”¨ã—ã€DeckMasterãƒ»MyDeckãƒ»Statisticsã®å„APIç”¨ã®ãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•°ã‚’ä½œæˆã™ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯TASK-0002ã§å®Ÿè£…ã—ãŸãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ç”¨ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**:
  - [TASK-0001](TASK-0001.md) - å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»å‹å®šç¾©ã®å®Ÿè£…
  - [TASK-0002](TASK-0002.md) - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0005ã€œTASK-0008, TASK-0015, TASK-0016ï¼ˆPhase 2ä»¥é™ã®ã‚¿ã‚¹ã‚¯ï¼‰

## å®Œäº†æ¡ä»¶

- [ ] DeckMaster API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆGET/POST/PUT/DELETEï¼‰
- [ ] MyDeck API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆGET/POST/DELETEï¼‰
- [ ] Statistics API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆGET with season paramï¼‰
- [ ] Seasons API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆGET available seasonsï¼‰
- [ ] å…±é€šã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒçµ±åˆã•ã‚Œã¦ã„ã‚‹
- [ ] ValidationError/DeleteConstraintErrorã®ãƒ‘ãƒ¼ã‚¹ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨
- [ ] å…¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒãƒ‘ã‚¹ã—ã¦ã„ã‚‹
- [ ] TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨

---

## å®Ÿè£…è©³ç´°

### 1. DeckMaster API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•° ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *architecture.md APIè¨­è¨ˆã«åŸºã¥ã*

DeckMasterã®CRUDæ“ä½œã‚’è¡Œã†APIé–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
import { apiClient } from './client';
import type {
  DeckMaster,
  DeckMasterWithUsage,
  DeckMasterCreateRequest,
  DeckMasterUpdateRequest,
  DeckMasterQueryParams,
} from '@shadowverse-log/shared';

/**
 * ãƒ‡ãƒƒã‚­ç¨®åˆ¥ä¸€è¦§ã‚’å–å¾—
 * @param params - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆincludeUsage: ä½¿ç”¨å±¥æ­´ã‚’å«ã‚ã‚‹ã‹ï¼‰
 */
export async function fetchDeckMasters(
  params?: DeckMasterQueryParams
): Promise<DeckMaster[]> {
  const queryString = params?.includeUsage ? '?includeUsage=true' : '';
  return apiClient.get<DeckMaster[]>(`/deck-masters${queryString}`);
}

/**
 * ä½¿ç”¨å±¥æ­´ä»˜ããƒ‡ãƒƒã‚­ç¨®åˆ¥ä¸€è¦§ã‚’å–å¾—
 */
export async function fetchDeckMastersWithUsage(): Promise<DeckMasterWithUsage[]> {
  return apiClient.get<DeckMasterWithUsage[]>('/deck-masters?includeUsage=true');
}

/**
 * ãƒ‡ãƒƒã‚­ç¨®åˆ¥ã‚’è¿½åŠ 
 * @param data - è¿½åŠ ãƒ‡ãƒ¼ã‚¿
 */
export async function createDeckMaster(data: DeckMasterCreateRequest): Promise<DeckMaster> {
  return apiClient.post<DeckMaster>('/deck-masters', data);
}

/**
 * ãƒ‡ãƒƒã‚­ç¨®åˆ¥ã‚’æ›´æ–°
 * @param id - ãƒ‡ãƒƒã‚­ç¨®åˆ¥ID
 * @param data - æ›´æ–°ãƒ‡ãƒ¼ã‚¿
 */
export async function updateDeckMaster(
  id: string,
  data: DeckMasterUpdateRequest
): Promise<DeckMaster> {
  return apiClient.put<DeckMaster>(`/deck-masters/${id}`, data);
}

/**
 * ãƒ‡ãƒƒã‚­ç¨®åˆ¥ã‚’å‰Šé™¤
 * @param id - ãƒ‡ãƒƒã‚­ç¨®åˆ¥ID
 */
export async function deleteDeckMaster(id: string): Promise<void> {
  return apiClient.del<void>(`/deck-masters/${id}`);
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/deck-master.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

---

### 2. MyDeck API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•° ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *architecture.md APIè¨­è¨ˆã«åŸºã¥ã*

MyDeckã®CRUDæ“ä½œã‚’è¡Œã†APIé–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
import { apiClient } from './client';
import type { MyDeck, MyDeckCreateRequest } from '@shadowverse-log/shared';

/**
 * ä½¿ç”¨ãƒ‡ãƒƒã‚­ä¸€è¦§ã‚’å–å¾—
 */
export async function fetchMyDecks(): Promise<MyDeck[]> {
  return apiClient.get<MyDeck[]>('/my-decks');
}

/**
 * ä½¿ç”¨ãƒ‡ãƒƒã‚­ã‚’è¿½åŠ 
 * @param data - è¿½åŠ ãƒ‡ãƒ¼ã‚¿
 */
export async function createMyDeck(data: MyDeckCreateRequest): Promise<MyDeck> {
  return apiClient.post<MyDeck>('/my-decks', data);
}

/**
 * ä½¿ç”¨ãƒ‡ãƒƒã‚­ã‚’å‰Šé™¤
 * @param id - ä½¿ç”¨ãƒ‡ãƒƒã‚­ID
 */
export async function deleteMyDeck(id: string): Promise<void> {
  return apiClient.del<void>(`/my-decks/${id}`);
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/my-deck.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

---

### 3. Statistics API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–¢æ•° ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *requirements.md REQ-EXT-203ã€œREQ-EXT-205å¯¾å¿œ*

ã‚·ãƒ¼ã‚ºãƒ³åˆ¥çµ±è¨ˆå–å¾—ã®APIé–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
import { apiClient } from './client';
import type { SeasonStatistics, StatisticsQueryParams } from '@shadowverse-log/shared';

/**
 * åˆ©ç”¨å¯èƒ½ãªã‚·ãƒ¼ã‚ºãƒ³ä¸€è¦§ã‚’å–å¾—
 */
export async function fetchAvailableSeasons(): Promise<number[]> {
  return apiClient.get<number[]>('/statistics/seasons');
}

/**
 * çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
 * @param params - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆseason: ã‚·ãƒ¼ã‚ºãƒ³ç•ªå·ï¼‰
 */
export async function fetchStatistics(
  params?: StatisticsQueryParams
): Promise<SeasonStatistics> {
  const queryString = params?.season ? `?season=${params.season}` : '';
  return apiClient.get<SeasonStatistics>(`/statistics${queryString}`);
}

/**
 * æŒ‡å®šã‚·ãƒ¼ã‚ºãƒ³ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
 * @param season - ã‚·ãƒ¼ã‚ºãƒ³ç•ªå·
 */
export async function fetchStatisticsBySeason(season: number): Promise<SeasonStatistics> {
  return fetchStatistics({ season });
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/statistics.ts`ï¼ˆæ–°è¦ä½œæˆã¾ãŸã¯æ‹¡å¼µï¼‰

---

### 4. ApiClientã‚¯ãƒ©ã‚¹ã®PUTãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ  ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ—¢å­˜APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æ¨æ¸¬*

æ—¢å­˜ã®ApiClientã‚¯ãƒ©ã‚¹ã«PUTãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã€‚

```typescript
/**
 * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: PUTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
 * ã€å®Ÿè£…æ–¹é‡ã€‘: requestãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’PUTã«æŒ‡å®šã€bodyã‚’JSONåŒ–
 * ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: æ—¢å­˜POSTãƒ¡ã‚½ãƒƒãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åŸºã¥ã„ãŸå®Ÿè£…
 *
 * @param endpoint - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆä¾‹: /deck-masters/:idï¼‰
 * @param body - ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ï¼ˆJSONåŒ–ã•ã‚Œã‚‹ï¼‰
 * @returns Promise<T> - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿
 */
async put<T>(endpoint: string, body: unknown): Promise<T> {
  return this.request<T>(endpoint, {
    method: 'PUT',
    body: JSON.stringify(body),
  });
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/client.ts`ï¼ˆæ‹¡å¼µï¼‰

---

### 5. APIã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ã‚¬ãƒ¼ãƒ‰çµ±åˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *TASK-0002ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ´»ç”¨*

APIã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é©åˆ‡ãªå‹ã«ãƒ‘ãƒ¼ã‚¹ã™ã‚‹å‡¦ç†ã‚’çµ±åˆã™ã‚‹ã€‚

```typescript
import {
  isValidationError,
  isDeleteConstraintError,
  translateApiError,
} from '@shadowverse-log/shared';

/**
 * APIã‚¨ãƒ©ãƒ¼ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›
 * @param error - APIã‹ã‚‰è¿”ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼
 */
export function handleApiError(error: unknown): string {
  // ValidationError ã¾ãŸã¯ DeleteConstraintError ã®å ´åˆã¯æ—¥æœ¬èªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›
  return translateApiError(error);
}

/**
 * APIã‚¨ãƒ©ãƒ¼ãŒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã‹ã©ã†ã‹ã‚’åˆ¤å®š
 * @param error - APIã‹ã‚‰è¿”ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼
 */
export { isValidationError, isDeleteConstraintError };
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/error-handler.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

---

### 6. Index.tsã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ  ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã†*

æ–°è¦è¿½åŠ ã—ãŸAPIé–¢æ•°ã‚’index.tsã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã€‚

```typescript
// apps/web/src/api/index.ts
export * from './client';
export * from './deck-master';
export * from './my-deck';
export * from './statistics';
export * from './error-handler';
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/api/index.ts`ï¼ˆæ–°è¦ä½œæˆã¾ãŸã¯æ‹¡å¼µï¼‰

---

## å˜ä½“ãƒ†ã‚¹ãƒˆè¦ä»¶

### fetchDeckMasters - æ­£å¸¸ç³» ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *APIé–¢æ•°ãƒ†ã‚¹ãƒˆ*

**Given**: APIã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¸¸ã«ç¨¼åƒã—ã¦ã„ã‚‹
**When**: fetchDeckMasters()ã‚’å‘¼ã³å‡ºã™
**Then**: DeckMaster[]ãŒè¿”ã•ã‚Œã‚‹

---

### fetchDeckMasters - ä½¿ç”¨å±¥æ­´ä»˜ã ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *APIé–¢æ•°ãƒ†ã‚¹ãƒˆ*

**Given**: APIã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¸¸ã«ç¨¼åƒã—ã¦ã„ã‚‹
**When**: fetchDeckMasters({ includeUsage: true })ã‚’å‘¼ã³å‡ºã™
**Then**: DeckMasterWithUsage[]ãŒè¿”ã•ã‚Œã‚‹

---

### createDeckMaster - æˆåŠŸæ™‚ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *APIé–¢æ•°ãƒ†ã‚¹ãƒˆ*

**Given**: æœ‰åŠ¹ãªDeckMasterCreateRequestãŒä¸ãˆã‚‰ã‚Œã‚‹
**When**: createDeckMaster(data)ã‚’å‘¼ã³å‡ºã™
**Then**: ä½œæˆã•ã‚ŒãŸDeckMasterãŒè¿”ã•ã‚Œã‚‹

---

### createDeckMaster - ValidationErroræ™‚ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ*

**Given**: ç©ºã®deckNameãŒä¸ãˆã‚‰ã‚Œã‚‹
**When**: createDeckMaster(data)ã‚’å‘¼ã³å‡ºã™
**Then**: ValidationErrorãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹

---

### deleteDeckMaster - DeleteConstraintErroræ™‚ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ*

**Given**: å¯¾æˆ¦å±¥æ­´ã§å‚ç…§ã•ã‚Œã¦ã„ã‚‹DeckMasterã®IDãŒä¸ãˆã‚‰ã‚Œã‚‹
**When**: deleteDeckMaster(id)ã‚’å‘¼ã³å‡ºã™
**Then**: DeleteConstraintErrorãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹

---

### fetchStatistics - ã‚·ãƒ¼ã‚ºãƒ³æŒ‡å®š ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *APIé–¢æ•°ãƒ†ã‚¹ãƒˆ*

**Given**: ã‚·ãƒ¼ã‚ºãƒ³ç•ªå·1ãŒæŒ‡å®šã•ã‚Œã‚‹
**When**: fetchStatistics({ season: 1 })ã‚’å‘¼ã³å‡ºã™
**Then**: ã‚·ãƒ¼ã‚ºãƒ³1ã®SeasonStatisticsãŒè¿”ã•ã‚Œã‚‹

---

### fetchAvailableSeasons - æ­£å¸¸ç³» ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *APIé–¢æ•°ãƒ†ã‚¹ãƒˆ*

**Given**: APIã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¸¸ã«ç¨¼åƒã—ã¦ã„ã‚‹
**When**: fetchAvailableSeasons()ã‚’å‘¼ã³å‡ºã™
**Then**: number[]ï¼ˆã‚·ãƒ¼ã‚ºãƒ³ç•ªå·ã®é…åˆ—ï¼‰ãŒè¿”ã•ã‚Œã‚‹

---

### put ãƒ¡ã‚½ãƒƒãƒ‰ - æ­£å¸¸ç³» ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æ¨æ¸¬*

**Given**: æœ‰åŠ¹ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ãƒœãƒ‡ã‚£ãŒä¸ãˆã‚‰ã‚Œã‚‹
**When**: apiClient.put(endpoint, body)ã‚’å‘¼ã³å‡ºã™
**Then**: æ›´æ–°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒè¿”ã•ã‚Œã‚‹

---

## å®Ÿè£…æ‰‹é †

### TDDã‚¿ã‚¹ã‚¯ã®å ´åˆ
1. `/tsumiki:tdd-requirements TASK-0004` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

### è©³ç´°æ‰‹é †

1. **ApiClientã‚¯ãƒ©ã‚¹ã«PUTãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ **: `apps/web/src/api/client.ts`ã‚’æ‹¡å¼µ
2. **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**: `apps/web/src/api/__tests__/deck-master.test.ts`
3. **DeckMaster APIé–¢æ•°ã®ãƒ†ã‚¹ãƒˆä½œæˆ**: CRUDæ“ä½œã®ãƒ†ã‚¹ãƒˆ
4. **DeckMaster APIé–¢æ•°ã®å®Ÿè£…**: `apps/web/src/api/deck-master.ts`
5. **MyDeck APIé–¢æ•°ã®ãƒ†ã‚¹ãƒˆä½œæˆ**: `apps/web/src/api/__tests__/my-deck.test.ts`
6. **MyDeck APIé–¢æ•°ã®å®Ÿè£…**: `apps/web/src/api/my-deck.ts`
7. **Statistics APIé–¢æ•°ã®ãƒ†ã‚¹ãƒˆä½œæˆ**: `apps/web/src/api/__tests__/statistics.test.ts`
8. **Statistics APIé–¢æ•°ã®å®Ÿè£…**: `apps/web/src/api/statistics.ts`
9. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼çµ±åˆ**: `apps/web/src/api/error-handler.ts`
10. **Index.tsã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: ã™ã¹ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
11. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**: é‡è¤‡æ’é™¤ã€ã‚³ãƒ¼ãƒ‰å“è³ªæ”¹å–„
12. **çµ±åˆãƒ†ã‚¹ãƒˆ**: å…¨ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®æ•´åˆæ€§

### æ—¢å­˜ApiClientã‚¯ãƒ©ã‚¹ã®çŠ¶æ³

æ—¢å­˜ã®`client.ts`ã«ã¯ä»¥ä¸‹ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼š
- `get<T>(endpoint)`: GETãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ãï¼‰
- `post<T>(endpoint, body)`: POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- `del<T>(endpoint)`: DELETEãƒªã‚¯ã‚¨ã‚¹ãƒˆ

### è¿½åŠ ãŒå¿…è¦ãªæ©Ÿèƒ½

- `put<T>(endpoint, body)`: PUTãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆãƒ‡ãƒƒã‚­ç¨®åˆ¥æ›´æ–°ç”¨ï¼‰

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®šã®æ›´æ–°

æ—¢å­˜ã®CACHE_TTLè¨­å®šï¼š
```typescript
const CACHE_TTL: Record<string, number> = {
  '/deck-masters': 60 * 60 * 1000, // 1æ™‚é–“
  '/my-decks': 60 * 60 * 1000, // 1æ™‚é–“
  '/statistics': 5 * 60 * 1000, // 5åˆ†
};
```

ã‚·ãƒ¼ã‚ºãƒ³ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ãŒå¿…è¦ï¼š
```typescript
  '/statistics/seasons': 5 * 60 * 1000, // 5åˆ†
```

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 14é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 12é …ç›® (86%)
- ğŸŸ¡ **é»„ä¿¡å·**: 2é …ç›® (14%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ªï¼ˆã»ã¼ã™ã¹ã¦ãŒæ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨è¨­è¨ˆæ–‡æ›¸ã«åŸºã¥ãï¼‰
