# TASK-0001: å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»å‹å®šç¾©ã®å®Ÿè£…

**ã‚¿ã‚¹ã‚¯ID**: TASK-0001
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: DIRECT
**æ¨å®šå·¥æ•°**: 2æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 1 - åŸºç›¤ãƒ»å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸ”µ *interfaces.tsã‚ˆã‚Š*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [ğŸ“‹ overview.md](overview.md)
- **è¦ä»¶å®šç¾©**: [ğŸ“‹ requirements.md](../../spec/deck-management-extension/requirements.md)
- **è¨­è¨ˆæ–‡æ›¸**: [ğŸ“ architecture.md](../../design/deck-management-extension/architecture.md)
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©**: [ğŸ“ interfaces.ts](../../design/deck-management-extension/interfaces.ts)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

ãƒ‡ãƒƒã‚­ç®¡ç†æ©Ÿèƒ½æ‹¡å¼µã«å¿…è¦ãªå…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»å‹å®šç¾©ã‚’å®Ÿè£…ã™ã‚‹ã€‚è¨­è¨ˆæ–‡æ›¸ï¼ˆinterfaces.tsï¼‰ã§å®šç¾©ã•ã‚ŒãŸå‹ã‚’sharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«é…ç½®ã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ä¸¡æ–¹ã‹ã‚‰åˆ©ç”¨å¯èƒ½ã«ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: ãªã—
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: [TASK-0002](TASK-0002.md), [TASK-0003](TASK-0003.md), [TASK-0004](TASK-0004.md)

## å®Œäº†æ¡ä»¶

- [ ] DeckMasterWithUsageå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] SeasonStatisticså‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] DeckMasterCreateRequest/UpdateRequestå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] MyDeckCreateRequestå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] StatisticsQueryParamså‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] ValidationErrorå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] DeleteConstraintErrorå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] DeckStoreå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] StatisticsStoreå‹ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] API_ERROR_CODESå®šæ•°ãŒsharedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨
- [ ] æ—¢å­˜ã®å‹å®šç¾©ã¨ã®äº’æ›æ€§ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹ã“ã¨

---

## å®Ÿè£…è©³ç´°

### 1. DeckMasterWithUsageå‹ã®å®Ÿè£… ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts REQ-EXT-302å¯¾å¿œ*

ä½¿ç”¨å±¥æ­´ä»˜ããƒ‡ãƒƒã‚­ç¨®åˆ¥ã®å‹ã‚’å®Ÿè£…ã™ã‚‹ã€‚ç›¸æ‰‹ãƒ‡ãƒƒã‚­é¸æŠè‚¢ã®ã‚½ãƒ¼ãƒˆç”¨ã«ã€æœ€çµ‚ä½¿ç”¨æ—¥ã¨ä½¿ç”¨å›æ•°ã‚’ä¿æŒã™ã‚‹ã€‚

```typescript
export interface DeckMasterWithUsage extends DeckMaster {
  /** æœ€å¾Œã«å¯¾æˆ¦ç›¸æ‰‹ã¨ã—ã¦ä½¿ç”¨ã•ã‚ŒãŸæ—¥ä»˜ */
  lastUsedDate: string | null;
  /** å¯¾æˆ¦ç›¸æ‰‹ã¨ã—ã¦ä½¿ç”¨ã•ã‚ŒãŸå›æ•° */
  usageCount: number;
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `packages/shared/src/types/deck-master.ts`

---

### 2. SeasonStatisticså‹ã®å®Ÿè£… ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts REQ-EXT-203ã€œREQ-EXT-205å¯¾å¿œ*

ã‚·ãƒ¼ã‚ºãƒ³çµ±è¨ˆæƒ…å ±ã®å‹ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
export interface SeasonStatistics {
  /** ã‚·ãƒ¼ã‚ºãƒ³ç•ªå· */
  season: number;
  /** ç·å¯¾æˆ¦æ•° */
  totalMatches: number;
  /** å‹åˆ©æ•° */
  wins: number;
  /** æ•—åŒ—æ•° */
  losses: number;
  /** å‹ç‡ï¼ˆãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆï¼‰ */
  winRate: number;
  /** å…ˆæ”»å‹ç‡ */
  firstWinRate: number;
  /** å¾Œæ”»å‹ç‡ */
  secondWinRate: number;
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `packages/shared/src/types/statistics.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

---

### 3. APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå‹ã®å®Ÿè£… ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts REQ-EXT-001ã€œREQ-EXT-107å¯¾å¿œ*

ãƒ‡ãƒƒã‚­ç¨®åˆ¥ãƒ»ä½¿ç”¨ãƒ‡ãƒƒã‚­ã®CRUDæ“ä½œã«å¿…è¦ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå‹ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
// DeckMasterç”¨
export interface DeckMasterCreateRequest {
  className: string;
  deckName: string;
}

export interface DeckMasterUpdateRequest {
  deckName: string;
}

// MyDeckç”¨
export interface MyDeckCreateRequest {
  deckId: string;
  deckName: string;
  deckCode?: string;
}

// çµ±è¨ˆç”¨
export interface StatisticsQueryParams {
  season?: number;
}

export interface DeckMasterQueryParams {
  includeUsage?: boolean;
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `packages/shared/src/types/deck-master.ts`
- `packages/shared/src/types/my-deck.ts`
- `packages/shared/src/types/statistics.ts`

---

### 4. APIã‚¨ãƒ©ãƒ¼å‹ã®å®Ÿè£… ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts REQ-EXT-401ã€œREQ-EXT-403å¯¾å¿œ*

ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã¨å‰Šé™¤åˆ¶ç´„ã‚¨ãƒ©ãƒ¼ã®å‹ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
export interface ValidationError {
  code: "VALIDATION_ERROR";
  message: string;
  details: {
    field: string;
    constraint: string;
    value: unknown;
  }[];
}

export interface DeleteConstraintError {
  code: "DELETE_CONSTRAINT_ERROR";
  message: string;
  details: {
    entityType: "deckMaster" | "myDeck";
    entityId: string;
    referencedBy: "battleLogs";
    referenceCount: number;
  };
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `packages/shared/src/types/api.ts`

---

### 5. Storeå‹ã®å®Ÿè£… ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts Zustand Storeå‹å®šç¾©*

Zustand Storeã®çŠ¶æ…‹ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å‹ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```typescript
export interface DeckStore {
  // çŠ¶æ…‹
  deckMasters: DeckMaster[];
  deckMastersWithUsage: DeckMasterWithUsage[];
  myDecks: MyDeck[];
  isLoading: boolean;
  error: string | null;

  // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  fetchDeckMasters: () => Promise<void>;
  fetchDeckMastersWithUsage: () => Promise<void>;
  fetchMyDecks: () => Promise<void>;
  addDeckMaster: (data: DeckMasterCreateRequest) => Promise<void>;
  updateDeckMaster: (id: string, data: DeckMasterUpdateRequest) => Promise<void>;
  deleteDeckMaster: (id: string) => Promise<void>;
  addMyDeck: (data: MyDeckCreateRequest) => Promise<void>;
  deleteMyDeck: (id: string) => Promise<void>;
  clearError: () => void;
}

export interface StatisticsStore {
  // çŠ¶æ…‹
  statistics: SeasonStatistics | null;
  selectedSeason: number | null;
  availableSeasons: number[];
  isLoading: boolean;
  error: string | null;

  // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  fetchStatistics: () => Promise<void>;
  fetchSeasons: () => Promise<void>;
  setSelectedSeason: (season: number) => void;
  fetchStatisticsBySeason: (season: number) => Promise<void>;
  clearError: () => void;
}
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `packages/shared/src/types/store.ts`ï¼ˆæ–°è¦ä½œæˆï¼‰

---

### 6. å®šæ•°å®šç¾©ã®æ‹¡å¼µ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *interfaces.ts å®šæ•°å®šç¾©*

APIã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šæ•°ã‚’è¿½åŠ ã™ã‚‹ã€‚CLASS_NAMESã¯æ—¢å­˜ã®ãŸã‚å¤‰æ›´ä¸è¦ã€‚

```typescript
export const API_ERROR_CODES = {
  VALIDATION_ERROR: "VALIDATION_ERROR",
  DELETE_CONSTRAINT_ERROR: "DELETE_CONSTRAINT_ERROR",
  NOT_FOUND: "NOT_FOUND",
  INTERNAL_ERROR: "INTERNAL_ERROR",
} as const;

export type ApiErrorCode = (typeof API_ERROR_CODES)[keyof typeof API_ERROR_CODES];
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `packages/shared/src/constants/index.ts`

---

### 7. Index.tsã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ  ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã†*

æ–°è¦è¿½åŠ ã—ãŸå‹ãƒ»å®šæ•°ã‚’index.tsã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã€‚

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `packages/shared/src/types/index.ts`
- `packages/shared/src/index.ts`

---

## å®Ÿè£…æ‰‹é †

### DIRECTã‚¿ã‚¹ã‚¯ã®å ´åˆ
1. `/tsumiki:direct-setup` - ç›´æ¥å®Ÿè£…ãƒ»è¨­å®š
2. `/tsumiki:direct-verify` - å‹•ä½œç¢ºèªãƒ»å“è³ªç¢ºèª

### è©³ç´°æ‰‹é †

1. **statistics.tsæ–°è¦ä½œæˆ**: SeasonStatisticså‹ã¨StatisticsQueryParamså‹ã‚’å®šç¾©
2. **store.tsæ–°è¦ä½œæˆ**: DeckStoreå‹ã¨StatisticsStoreå‹ã‚’å®šç¾©
3. **deck-master.tsæ‹¡å¼µ**: DeckMasterWithUsageã€DeckMasterCreateRequestã€DeckMasterUpdateRequestã€DeckMasterQueryParamså‹ã‚’è¿½åŠ 
4. **my-deck.tsæ‹¡å¼µ**: MyDeckCreateRequestå‹ã‚’è¿½åŠ 
5. **api.tsæ‹¡å¼µ**: ValidationErrorã€DeleteConstraintErrorå‹ã‚’è¿½åŠ 
6. **constants/index.tsæ‹¡å¼µ**: API_ERROR_CODESå®šæ•°ã‚’è¿½åŠ 
7. **types/index.tsæ›´æ–°**: æ–°è¦å‹ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’è¿½åŠ 
8. **TypeScriptãƒ“ãƒ«ãƒ‰ç¢ºèª**: `npm run build` ã§ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 7é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 7é …ç›® (100%)
- ğŸŸ¡ **é»„ä¿¡å·**: 0é …ç›® (0%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ªï¼ˆã™ã¹ã¦ã®å®šç¾©ãŒinterfaces.tsã®è¨­è¨ˆæ–‡æ›¸ã«åŸºã¥ãï¼‰
