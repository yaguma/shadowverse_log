# TASK-0019: MyDeckItemã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

- **ã‚¿ã‚¹ã‚¯ID**: TASK-0019
- **ã‚¿ã‚¤ãƒˆãƒ«**: MyDeckItemã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- **ã‚¿ã‚¤ãƒ—**: TDD
- **æ¨å®šå·¥æ•°**: 2æ™‚é–“
- **ãƒ•ã‚§ãƒ¼ã‚º**: Phase 3 - ä½¿ç”¨ãƒ‡ãƒƒã‚­ç®¡ç†æ©Ÿèƒ½
- **ä¿¡é ¼æ€§**: ğŸ”µï¼ˆinterfaces.ts MyDeckItemPropsã‚ˆã‚Šï¼‰
- **ä¾å­˜ã‚¿ã‚¹ã‚¯**: TASK-0018
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0020
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: [ ] æœªç€æ‰‹

---

## è¦ä»¶

### æ©Ÿèƒ½è¦ä»¶

- deckName, deckCode, className è¡¨ç¤º
- å‰Šé™¤ãƒœã‚¿ãƒ³ï¼ˆå‚ç…§ã‚ã‚Šã§ç„¡åŠ¹åŒ–ï¼‰
- å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

---

## å®Ÿè£…è©³ç´°

### 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆPropså®šç¾©

```typescript
// packages/web/src/components/deck/types.ts

import type { MyDeck } from '@shadowverse-log/shared';

export interface MyDeckItemProps {
  /** ä½¿ç”¨ãƒ‡ãƒƒã‚­ */
  deck: MyDeck;
  /** å‰Šé™¤å¯èƒ½ã‹ã©ã†ã‹ */
  canDelete: boolean;
  /** å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ */
  onDeleteClick: () => void;
}
```

### 2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…

```typescript
// packages/web/src/components/deck/MyDeckItem.tsx

import { FC, useState } from 'react';
import { Button } from '../common/Button';
import { ConfirmDialog } from '../common/ConfirmDialog';
import type { MyDeckItemProps } from './types';

export const MyDeckItem: FC<MyDeckItemProps> = ({
  deck,
  canDelete,
  onDeleteClick,
}) => {
  const [isConfirmOpen, setIsConfirmOpen] = useState(false);

  const handleDeleteClick = () => {
    setIsConfirmOpen(true);
  };

  const handleConfirm = () => {
    setIsConfirmOpen(false);
    onDeleteClick();
  };

  const handleCancel = () => {
    setIsConfirmOpen(false);
  };

  return (
    <>
      <div
        className="flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow"
        data-testid={`deck-item-${deck.id}`}
      >
        {/* ãƒ‡ãƒƒã‚­æƒ…å ± */}
        <div className="flex-1 min-w-0">
          <div className="flex items-center gap-2">
            <span
              className="inline-block px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded"
              data-testid="deck-class-name"
            >
              {deck.className}
            </span>
            <h3 className="text-lg font-semibold truncate" data-testid="deck-name">
              {deck.deckName}
            </h3>
          </div>
          {deck.deckCode && (
            <p
              className="mt-1 text-sm text-gray-500 font-mono truncate"
              data-testid="deck-code"
            >
              {deck.deckCode}
            </p>
          )}
        </div>

        {/* å‰Šé™¤ãƒœã‚¿ãƒ³ */}
        <div className="ml-4 flex-shrink-0">
          <Button
            variant="danger"
            size="sm"
            onClick={handleDeleteClick}
            disabled={!canDelete}
            title={canDelete ? 'å‰Šé™¤' : 'å¯¾æˆ¦å±¥æ­´ã‹ã‚‰å‚ç…§ã•ã‚Œã¦ã„ã‚‹ãŸã‚å‰Šé™¤ã§ãã¾ã›ã‚“'}
            data-testid="delete-button"
          >
            å‰Šé™¤
          </Button>
        </div>
      </div>

      {/* å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}
      <ConfirmDialog
        isOpen={isConfirmOpen}
        title="ãƒ‡ãƒƒã‚­ã®å‰Šé™¤"
        message={`ã€Œ${deck.deckName}ã€ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚`}
        confirmLabel="å‰Šé™¤"
        cancelLabel="ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
        variant="danger"
        onConfirm={handleConfirm}
        onCancel={handleCancel}
        data-testid="confirm-dialog"
      />
    </>
  );
};
```

### 3. ConfirmDialogã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆå…±é€šï¼‰

```typescript
// packages/web/src/components/common/ConfirmDialog.tsx

import { FC } from 'react';
import { Button } from './Button';

export interface ConfirmDialogProps {
  isOpen: boolean;
  title: string;
  message: string;
  confirmLabel?: string;
  cancelLabel?: string;
  variant?: 'default' | 'danger';
  onConfirm: () => void;
  onCancel: () => void;
}

export const ConfirmDialog: FC<ConfirmDialogProps> = ({
  isOpen,
  title,
  message,
  confirmLabel = 'ç¢ºèª',
  cancelLabel = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
  variant = 'default',
  onConfirm,
  onCancel,
}) => {
  if (!isOpen) return null;

  return (
    <div
      className="fixed inset-0 z-50 flex items-center justify-center"
      data-testid="confirm-dialog"
    >
      {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}
      <div
        className="absolute inset-0 bg-black/50"
        onClick={onCancel}
        data-testid="confirm-dialog-overlay"
      />

      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°æœ¬ä½“ */}
      <div className="relative bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
        <h2 className="text-lg font-semibold mb-2" data-testid="confirm-dialog-title">
          {title}
        </h2>
        <p className="text-gray-600 mb-6" data-testid="confirm-dialog-message">
          {message}
        </p>
        <div className="flex justify-end gap-3">
          <Button
            variant="secondary"
            onClick={onCancel}
            data-testid="confirm-dialog-cancel"
          >
            {cancelLabel}
          </Button>
          <Button
            variant={variant === 'danger' ? 'danger' : 'primary'}
            onClick={onConfirm}
            data-testid="confirm-dialog-confirm"
          >
            {confirmLabel}
          </Button>
        </div>
      </div>
    </div>
  );
};
```

### 4. Storybook Story

```typescript
// packages/web/src/components/deck/MyDeckItem.stories.tsx

import type { Meta, StoryObj } from '@storybook/react';
import { MyDeckItem } from './MyDeckItem';

const meta: Meta<typeof MyDeckItem> = {
  title: 'Deck/MyDeckItem',
  component: MyDeckItem,
  tags: ['autodocs'],
};

export default meta;
type Story = StoryObj<typeof MyDeckItem>;

const sampleDeck = {
  id: '1',
  deckId: 'deck-001',
  deckName: 'ç§˜è¡“ã‚ªãƒ‡ãƒ³ã‚¹ãƒšãƒ«',
  deckCode: 'ABC123DEF456',
  className: 'ã‚¦ã‚£ãƒƒãƒ',
  isActive: true,
  createdAt: '2025-01-01T00:00:00.000Z',
};

export const Default: Story = {
  args: {
    deck: sampleDeck,
    canDelete: true,
    onDeleteClick: () => console.log('Delete clicked'),
  },
};

export const WithoutDeckCode: Story = {
  args: {
    deck: {
      ...sampleDeck,
      deckCode: '',
    },
    canDelete: true,
    onDeleteClick: () => console.log('Delete clicked'),
  },
};

export const CannotDelete: Story = {
  args: {
    deck: sampleDeck,
    canDelete: false,
    onDeleteClick: () => console.log('Delete clicked'),
  },
};

export const LongDeckName: Story = {
  args: {
    deck: {
      ...sampleDeck,
      deckName: 'ã¨ã¦ã‚‚é•·ã„ãƒ‡ãƒƒã‚­åã§ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒƒã‚­',
    },
    canDelete: true,
    onDeleteClick: () => console.log('Delete clicked'),
  },
};
```

---

## ãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§

| No | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æœŸå¾…çµæœ | å„ªå…ˆåº¦ |
|----|-------------|----------|--------|
| 1 | deckNameãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ãƒ‡ãƒƒã‚­åè¡¨ç¤º | é«˜ |
| 2 | deckCodeãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ãƒ‡ãƒƒã‚­ã‚³ãƒ¼ãƒ‰è¡¨ç¤º | é«˜ |
| 3 | classNameãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ã‚¯ãƒ©ã‚¹åè¡¨ç¤º | é«˜ |
| 4 | å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º | é«˜ |
| 5 | canDelete=falseã§å‰Šé™¤ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨ | disabledçŠ¶æ…‹ | é«˜ |
| 6 | ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œå‰Šé™¤ã€ã‚¯ãƒªãƒƒã‚¯æ™‚ã«onDeleteClickå‘¼ã³å‡ºã— | ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‘¼ã³å‡ºã— | é«˜ |
| 7 | deckCodeãŒç©ºã®å ´åˆã¯è¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ | éè¡¨ç¤º | ä¸­ |

### ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ä¾‹

```typescript
// packages/web/src/components/deck/__tests__/MyDeckItem.test.tsx

import { describe, it, expect, vi } from 'vitest';
import { render, screen, fireEvent } from '@testing-library/react';
import { MyDeckItem } from '../MyDeckItem';

const sampleDeck = {
  id: '1',
  deckId: 'deck-001',
  deckName: 'ç§˜è¡“ã‚ªãƒ‡ãƒ³ã‚¹ãƒšãƒ«',
  deckCode: 'ABC123',
  className: 'ã‚¦ã‚£ãƒƒãƒ',
  isActive: true,
  createdAt: '2025-01-01T00:00:00.000Z',
};

describe('MyDeckItem', () => {
  const defaultProps = {
    deck: sampleDeck,
    canDelete: true,
    onDeleteClick: vi.fn(),
  };

  describe('è¡¨ç¤º', () => {
    it('deckNameãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      expect(screen.getByTestId('deck-name')).toHaveTextContent('ç§˜è¡“ã‚ªãƒ‡ãƒ³ã‚¹ãƒšãƒ«');
    });

    it('deckCodeãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      expect(screen.getByTestId('deck-code')).toHaveTextContent('ABC123');
    });

    it('classNameãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      expect(screen.getByTestId('deck-class-name')).toHaveTextContent('ã‚¦ã‚£ãƒƒãƒ');
    });

    it('deckCodeãŒç©ºã®å ´åˆã¯è¡¨ç¤ºã•ã‚Œãªã„ã“ã¨', () => {
      render(
        <MyDeckItem
          {...defaultProps}
          deck={{ ...sampleDeck, deckCode: '' }}
        />
      );

      expect(screen.queryByTestId('deck-code')).not.toBeInTheDocument();
    });
  });

  describe('å‰Šé™¤ãƒœã‚¿ãƒ³', () => {
    it('å‰Šé™¤ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      expect(screen.getByTestId('delete-button')).toBeInTheDocument();
    });

    it('canDelete=falseã§å‰Šé™¤ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} canDelete={false} />);

      expect(screen.getByTestId('delete-button')).toBeDisabled();
    });

    it('canDelete=trueã§å‰Šé™¤ãƒœã‚¿ãƒ³ãŒæœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} canDelete={true} />);

      expect(screen.getByTestId('delete-button')).not.toBeDisabled();
    });
  });

  describe('å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°', () => {
    it('å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      fireEvent.click(screen.getByTestId('delete-button'));

      expect(screen.getByTestId('confirm-dialog')).toBeInTheDocument();
      expect(screen.getByTestId('confirm-dialog-message')).toHaveTextContent(
        'ã€Œç§˜è¡“ã‚ªãƒ‡ãƒ³ã‚¹ãƒšãƒ«ã€ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ'
      );
    });

    it('ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œå‰Šé™¤ã€ã‚¯ãƒªãƒƒã‚¯æ™‚ã«onDeleteClickãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨', () => {
      const onDeleteClick = vi.fn();
      render(<MyDeckItem {...defaultProps} onDeleteClick={onDeleteClick} />);

      // å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
      fireEvent.click(screen.getByTestId('delete-button'));
      // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œå‰Šé™¤ã€ã‚¯ãƒªãƒƒã‚¯
      fireEvent.click(screen.getByTestId('confirm-dialog-confirm'));

      expect(onDeleteClick).toHaveBeenCalledTimes(1);
    });

    it('ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‰ã˜ã‚‹ã“ã¨', () => {
      render(<MyDeckItem {...defaultProps} />);

      fireEvent.click(screen.getByTestId('delete-button'));
      expect(screen.getByTestId('confirm-dialog')).toBeInTheDocument();

      fireEvent.click(screen.getByTestId('confirm-dialog-cancel'));
      expect(screen.queryByTestId('confirm-dialog')).not.toBeInTheDocument();
    });

    it('ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ã‚¯ãƒªãƒƒã‚¯æ™‚ã«onDeleteClickãŒå‘¼ã³å‡ºã•ã‚Œãªã„ã“ã¨', () => {
      const onDeleteClick = vi.fn();
      render(<MyDeckItem {...defaultProps} onDeleteClick={onDeleteClick} />);

      fireEvent.click(screen.getByTestId('delete-button'));
      fireEvent.click(screen.getByTestId('confirm-dialog-cancel'));

      expect(onDeleteClick).not.toHaveBeenCalled();
    });
  });
});
```

---

## å®Œäº†æ¡ä»¶

- [ ] MyDeckItemã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] deckName, deckCode, classNameãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] å‰Šé™¤ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] canDelete=falseã§å‰Šé™¤ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹
- [ ] å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒæˆåŠŸã™ã‚‹
- [ ] Storybookã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç¢ºèªã§ãã‚‹

---

## å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# TDDãƒ•ãƒ­ãƒ¼
/tsumiki:tdd-red           # ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
/tsumiki:tdd-green         # æœ€å°å®Ÿè£…ï¼ˆæˆåŠŸï¼‰
/tsumiki:tdd-refactor      # ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
/tsumiki:tdd-verify-complete  # å“è³ªç¢ºèª
```

---

## æ¤œè¨¼æ‰‹é †

1. ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆRedï¼‰
2. æœ€å°é™ã®å®Ÿè£…ã§ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆGreenï¼‰
3. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã‚‚ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª
4. `pnpm test` ã§å…¨ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª
5. `pnpm storybook` ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
6. `pnpm lint` ã§ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª

---

## å‚è€ƒè³‡æ–™

- [interfaces.ts - MyDeckItemProps](../../../docs/design/deck-management-extension/interfaces.ts)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [Storybook Documentation](https://storybook.js.org/docs)
