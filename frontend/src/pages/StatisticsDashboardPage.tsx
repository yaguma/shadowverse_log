/**
 * ğŸ”µ REQ-201, REQ-202, REQ-203: Statistics Dashboard Page
 *
 * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ - å¯¾æˆ¦å±¥æ­´ã®é›†è¨ˆãƒ»åˆ†æã‚’è¡¨ç¤º
 * ã€ä¸»è¦æ©Ÿèƒ½ã€‘:
 *   - æœŸé–“é¸æŠæ©Ÿèƒ½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: éå»7æ—¥é–“ï¼‰
 *   - å…¨ä½“çµ±è¨ˆã€ãƒ‡ãƒƒã‚­åˆ¥çµ±è¨ˆã€ãƒ©ãƒ³ã‚¯å¸¯åˆ¥çµ±è¨ˆã€å…ˆæ”»å¾Œæ”»åˆ¥çµ±è¨ˆã®è¡¨ç¤º
 *   - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã€ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã€ç©ºãƒ‡ãƒ¼ã‚¿çŠ¶æ…‹ã®ç®¡ç†
 * ã€è¨­è¨ˆæ–¹é‡ã€‘:
 *   - useState ã«ã‚ˆã‚‹å˜ç´”ãª State ç®¡ç†ï¼ˆå°†æ¥çš„ã« Zustand ã¸ã®ç§»è¡Œã‚’æ¤œè¨ï¼‰
 *   - useEffect ã«ã‚ˆã‚‹è‡ªå‹•ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæœŸé–“å¤‰æ›´æ™‚ã«å³åº§ã«åæ˜ ï¼‰
 *   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†é›¢ã«ã‚ˆã‚‹é–¢å¿ƒã®åˆ†é›¢ã¨ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã®ç¢ºä¿
 * ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®ã€‘:
 *   - API å‘¼ã³å‡ºã—ã¯ useEffect ã§ç®¡ç†ï¼ˆå¿…è¦æœ€å°é™ã®å‘¼ã³å‡ºã—ï¼‰
 *   - æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹ä¸è¦ãªæç”»ã®å‰Šæ¸›
 */

import { useEffect, useState } from 'react';
import { apiClient, extractErrorMessage } from '../api/client';
import { DeckStatsTable } from '../components/statistics/DeckStatsTable';
import { EmptyState } from '../components/statistics/EmptyState';
import { Error } from '../components/statistics/Error';
import { Loading } from '../components/statistics/Loading';
import { OverallStats } from '../components/statistics/OverallStats';
import { PeriodSelector } from '../components/statistics/PeriodSelector';
import { RankStatsTable } from '../components/statistics/RankStatsTable';
import { TurnStats } from '../components/statistics/TurnStats';
import type { StatisticsResponse } from '../types';

/**
 * ã€å®šæ•°å®šç¾©ã€‘: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé›†è¨ˆæœŸé–“
 * ğŸ”µ REQ-202: çµ±è¨ˆæƒ…å ±ã®åˆæœŸè¡¨ç¤ºæœŸé–“ã‚’å®šç¾©
 * ã€è¨­å®šæ ¹æ‹ ã€‘: ç›´è¿‘1é€±é–“ãŒæœ€ã‚‚å‚ç…§é »åº¦ãŒé«˜ã„ãŸã‚
 */
const DEFAULT_PERIOD_DAYS = 7;

/**
 * ğŸ”µ REQ-201: Statistics Dashboard Page Component
 *
 * çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
 */
export function StatisticsDashboardPage() {
  // ğŸ”µ Stateç®¡ç†: æœŸé–“é¸æŠã€çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã€ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹
  const [startDate, setStartDate] = useState<string>('');
  const [endDate, setEndDate] = useState<string>('');
  const [statistics, setStatistics] = useState<StatisticsResponse | null>(null);
  const [isLoading, setIsLoading] = useState<boolean>(false);
  const [error, setError] = useState<string | null>(null);

  /**
   * ã€åˆæœŸåŒ–å‡¦ç†ã€‘: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœŸé–“ã®è¨­å®šï¼ˆéå»7æ—¥é–“ï¼‰
   * ğŸ”µ REQ-202: çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤ºæœŸé–“ã‚’è¨­å®š
   * ã€å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‘: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆå›ãƒã‚¦ãƒ³ãƒˆæ™‚ï¼ˆä¾å­˜é…åˆ—ãŒç©ºã®ãŸã‚1å›ã®ã¿ï¼‰
   * ã€è¨­è¨ˆæ„å›³ã€‘: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«æœŸé–“ã‚’é¸æŠã—ãªãã¦ã‚‚ã€æœ‰ç”¨ãªãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
   * ã€å®Ÿè£…è©³ç´°ã€‘:
   *   - ä»Šæ—¥ã®æ—¥ä»˜ã‚’çµ‚äº†æ—¥ã¨ã—ã¦è¨­å®š
   *   - DEFAULT_PERIOD_DAYS æ—¥å‰ã‚’é–‹å§‹æ—¥ã¨ã—ã¦è¨­å®š
   *   - YYYY-MM-DD å½¢å¼ã§æ—¥ä»˜æ–‡å­—åˆ—ã‚’ç”Ÿæˆï¼ˆHTML5 date input å¯¾å¿œï¼‰
   */
  useEffect(() => {
    // ã€ä»Šæ—¥ã®æ—¥ä»˜å–å¾—ã€‘: ISO 8601 å½¢å¼ã‹ã‚‰æ—¥ä»˜éƒ¨åˆ†ã®ã¿ã‚’æŠ½å‡º
    const today = new Date().toISOString().split('T')[0];

    // ã€éå»æ—¥ä»˜è¨ˆç®—ã€‘: DEFAULT_PERIOD_DAYS æ—¥å‰ã®æ—¥ä»˜ã‚’è¨ˆç®—
    // ãƒŸãƒªç§’å˜ä½ã§è¨ˆç®—: DEFAULT_PERIOD_DAYSæ—¥ Ã— 24æ™‚é–“ Ã— 60åˆ† Ã— 60ç§’ Ã— 1000ãƒŸãƒªç§’
    const periodStartDate = new Date(Date.now() - DEFAULT_PERIOD_DAYS * 24 * 60 * 60 * 1000)
      .toISOString()
      .split('T')[0];

    // ã€Stateæ›´æ–°ã€‘: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœŸé–“ã‚’ State ã«è¨­å®š
    // ã“ã®æ›´æ–°ã«ã‚ˆã‚Š useEffect (startDate, endDate) ãŒç™ºç«ã—ã€API å‘¼ã³å‡ºã—ãŒå®Ÿè¡Œã•ã‚Œã‚‹
    setStartDate(periodStartDate);
    setEndDate(today);
  }, []);

  /**
   * ã€çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ã€‘: Backend API ã‹ã‚‰çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
   * ğŸ”µ REQ-203: çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤ºæ©Ÿèƒ½
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: GET /api/statistics ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€State ã«åæ˜ 
   * ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€‘:
   *   - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€å†è©¦è¡Œã‚’ä¿ƒã™
   *   - ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
   * ã€Stateç®¡ç†ã€‘:
   *   - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®é©åˆ‡ãªç®¡ç†ï¼ˆé–‹å§‹â†’å®Œäº†/ã‚¨ãƒ©ãƒ¼ï¼‰
   *   - ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®ã‚¯ãƒªã‚¢ï¼ˆå†è©¦è¡Œæ™‚ã«å‰å›ã®ã‚¨ãƒ©ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆï¼‰
   * ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€‘:
   *   - éåŒæœŸå‡¦ç†ã«ã‚ˆã‚‹ UI ãƒ–ãƒ­ãƒƒã‚¯ã®å›é¿
   *   - try-catch-finally ã«ã‚ˆã‚‹ç¢ºå®Ÿãªãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ã‚¯ãƒªã‚¢
   */
  const fetchStatistics = async () => {
    // ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é–‹å§‹ã€‘: API å‘¼ã³å‡ºã—é–‹å§‹ã‚’ UI ã«é€šçŸ¥
    // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€å‰å›ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
    setIsLoading(true);
    setError(null);

    try {
      // ã€APIå‘¼ã³å‡ºã—ã€‘: Backend çµ±è¨ˆ API ã‚’å‘¼ã³å‡ºã—
      // ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: startDate, endDateï¼ˆYYYY-MM-DD å½¢å¼ï¼‰
      // ãƒ¬ã‚¹ãƒãƒ³ã‚¹: StatisticsResponse å‹ï¼ˆoverall, byMyDeck, byOpponentDeck, byRank, byTurnï¼‰
      const data = await apiClient.get<StatisticsResponse>(
        `/statistics?startDate=${startDate}&endDate=${endDate}`
      );

      // ã€æˆåŠŸæ™‚å‡¦ç†ã€‘: å–å¾—ã—ãŸçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ State ã«ä¿å­˜
      // ã“ã‚Œã«ã‚ˆã‚Šã€æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒç™ºç«ã—ã€çµ±è¨ˆæƒ…å ±ãŒç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹
      setStatistics(data);
    } catch (err) {
      // ã€ã‚¨ãƒ©ãƒ¼æ™‚å‡¦ç†ã€‘: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ½å‡ºã—ã¦ State ã«ä¿å­˜
      // extractErrorMessage: API ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã‹ã‚‰é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ½å‡º
      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã®å¯èƒ½æ€§ã‚’ç¤ºå”†
      setError(extractErrorMessage(err, 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'));
    } finally {
      // ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµ‚äº†ã€‘: æˆåŠŸãƒ»å¤±æ•—ã«é–¢ã‚ã‚‰ãšãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’è§£é™¤
      // finally ãƒ–ãƒ­ãƒƒã‚¯ã«ã‚ˆã‚Šã€ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ç¢ºå®Ÿã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’çµ‚äº†
      setIsLoading(false);
    }
  };

  /**
   * ã€æœŸé–“å¤‰æ›´æ™‚ã®è‡ªå‹•ãƒ‡ãƒ¼ã‚¿å–å¾—ã€‘: é–‹å§‹æ—¥ã¾ãŸã¯çµ‚äº†æ—¥ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰çµ±è¨ˆã‚’å†å–å¾—
   * ğŸ”µ REQ-202: æœŸé–“é¸æŠæ©Ÿèƒ½
   * ã€å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‘: startDate ã¾ãŸã¯ endDate ã® State ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚
   * ã€è¨­è¨ˆæ„å›³ã€‘:
   *   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ—¥ä»˜ã‚’å¤‰æ›´ã™ã‚‹ã¨å³åº§ã«çµ±è¨ˆãŒæ›´æ–°ã•ã‚Œã‚‹
   *   - ã€Œæ¤œç´¢ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã•ãªãã¦ã‚‚ã€æ—¥ä»˜å¤‰æ›´ã ã‘ã§è‡ªå‹•æ›´æ–°
   * ã€å®Ÿè£…è©³ç´°ã€‘:
   *   - ä¸¡æ–¹ã®æ—¥ä»˜ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿ API å‘¼ã³å‡ºã—ï¼ˆåˆæœŸåŒ–å‰ã®ç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯ï¼‰
   *   - fetchStatistics é–¢æ•°ã‚’ä¾å­˜é…åˆ—ã‹ã‚‰é™¤å¤–ï¼ˆeslint-disable ã‚’ä½¿ç”¨ï¼‰
   * ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®ã€‘:
   *   - ä¸¡æ–¹ã®æ—¥ä»˜ã‚’å¤‰æ›´ã™ã‚‹ã¨2å› API å‘¼ã³å‡ºã—ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š
   *   - ğŸŸ¡ å°†æ¥çš„ã«ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ã®è¿½åŠ ã‚’æ¤œè¨
   */
  useEffect(() => {
    // ã€APIå‘¼ã³å‡ºã—æ¡ä»¶ã€‘: ä¸¡æ–¹ã®æ—¥ä»˜ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿å®Ÿè¡Œ
    // åˆæœŸåŒ–å‰ï¼ˆç©ºæ–‡å­—ï¼‰ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã€ç„¡é§„ãª API å‘¼ã³å‡ºã—ã‚’é˜²ã
    if (startDate && endDate) {
      fetchStatistics();
    }
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [startDate, endDate]);

  /**
   * ã€æ¤œç´¢ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©ã€‘: æœŸé–“é¸æŠãƒ•ã‚©ãƒ¼ãƒ ã®ã€Œæ¤œç´¢ã€ãƒœã‚¿ãƒ³å‡¦ç†
   * ğŸŸ¡ ç¾åœ¨ã¯ useEffect ã«ã‚ˆã‚‹è‡ªå‹•å–å¾—ã®ãŸã‚ã€å®Ÿè³ªçš„ã«ä½•ã‚‚ã—ãªã„
   * ã€è¨­è¨ˆæ„å›³ã€‘:
   *   - å°†æ¥çš„ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã®è¿½åŠ ã‚’æƒ³å®šã—ãŸãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
   *   - æ¤œç´¢ãƒœã‚¿ãƒ³ã®å­˜åœ¨ã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ˜ç¤ºçš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æä¾›
   * ã€å°†æ¥ã®æ‹¡å¼µå€™è£œã€‘:
   *   - æ—¥ä»˜ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆstartDate <= endDate, æœªæ¥æ—¥ä»˜ç¦æ­¢ï¼‰
   *   - æ‰‹å‹•æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆuseEffect ã‚’ç„¡åŠ¹åŒ–ã—ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã¿å–å¾—ï¼‰
   */
  const handleSearch = () => {
    // ğŸŸ¡ useEffect ã§è‡ªå‹•çš„ã« fetchStatistics ãŒå‘¼ã°ã‚Œã‚‹ãŸã‚ã€ã“ã“ã§ã¯ä½•ã‚‚ã—ãªã„
    // ğŸŸ¡ å°†æ¥çš„ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š
  };

  /**
   * ã€å†è©¦è¡Œãƒãƒ³ãƒ‰ãƒ©ã€‘: ã‚¨ãƒ©ãƒ¼æ™‚ã®ã€Œå†è©¦è¡Œã€ãƒœã‚¿ãƒ³å‡¦ç†
   * ğŸ”µ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã‚„ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ã‹ã‚‰ã®å¾©æ—§æ©Ÿèƒ½
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã€Œå†è©¦è¡Œã€ãƒœã‚¿ãƒ³ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹
   * ã€å®Ÿè£…è©³ç´°ã€‘:
   *   - fetchStatistics é–¢æ•°ã‚’å†å®Ÿè¡Œ
   *   - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã¨ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã¯ fetchStatistics å†…ã§ç®¡ç†ã•ã‚Œã‚‹
   * ã€ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã€‘:
   *   - ä¸€æ™‚çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼å¾Œã«ã€ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã›ãšã«å¾©æ—§å¯èƒ½
   *   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚¯ãƒªã‚¢ã•ã‚Œã€æ–°ãŸãªãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   */
  const handleRetry = () => {
    fetchStatistics();
  };

  return (
    <div>
      {/* ğŸ”µ ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ */}
      <h2 className="text-xl font-bold mb-4">çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>

      {/* ğŸ”µ REQ-202: æœŸé–“é¸æŠãƒ•ã‚©ãƒ¼ãƒ  */}
      <PeriodSelector
        startDate={startDate}
        endDate={endDate}
        onStartDateChange={setStartDate}
        onEndDateChange={setEndDate}
        onSearch={handleSearch}
        isLoading={isLoading}
      />

      {/* ğŸ”µ REQ-502: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ */}
      {isLoading && <Loading />}

      {/* ğŸ”µ ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ */}
      {!isLoading && error && <Error message={error} onRetry={handleRetry} />}

      {/* ğŸ”µ REQ-405: ãƒ‡ãƒ¼ã‚¿ãªã—çŠ¶æ…‹ */}
      {!isLoading && !error && statistics && statistics.overall.totalGames === 0 && <EmptyState />}

      {/* ğŸ”µ REQ-203: çµ±è¨ˆæƒ…å ±è¡¨ç¤º */}
      {!isLoading && !error && statistics && statistics.overall.totalGames > 0 && (
        <div>
          {/* ğŸ”µ å…¨ä½“çµ±è¨ˆ */}
          <OverallStats stats={statistics.overall} />

          {/* ğŸ”µ ãƒ‡ãƒƒã‚­åˆ¥çµ±è¨ˆï¼ˆãƒã‚¤ãƒ‡ãƒƒã‚­ï¼‰ */}
          <DeckStatsTable title="ãƒã‚¤ãƒ‡ãƒƒã‚­åˆ¥çµ±è¨ˆ" deckStats={statistics.byMyDeck} />

          {/* ğŸ”µ ãƒ‡ãƒƒã‚­åˆ¥çµ±è¨ˆï¼ˆç›¸æ‰‹ãƒ‡ãƒƒã‚­ï¼‰ */}
          <DeckStatsTable title="ç›¸æ‰‹ãƒ‡ãƒƒã‚­åˆ¥çµ±è¨ˆ" deckStats={statistics.byOpponentDeck} />

          {/* ğŸ”µ ãƒ©ãƒ³ã‚¯å¸¯åˆ¥çµ±è¨ˆ */}
          <RankStatsTable rankStats={statistics.byRank} />

          {/* ğŸ”µ å…ˆæ”»å¾Œæ”»åˆ¥çµ±è¨ˆ */}
          <TurnStats turnStats={statistics.byTurn} />
        </div>
      )}
    </div>
  );
}
